<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[小灰灰写代码]]></title>
  <subtitle><![CDATA[码农，程序猿]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://lulee007.gitcafe.io/"/>
  <updated>2016-01-24T07:10:26.000Z</updated>
  <id>http://lulee007.gitcafe.io/</id>
  
  <author>
    <name><![CDATA[Lulee007]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[Hexo博客优化配置之--为自己博客添加站内搜索]]></title>
    <link href="http://lulee007.gitcafe.io/2016/01/23/Hexo%E5%8D%9A%E5%AE%A2%E4%BC%98%E5%8C%96%E9%85%8D%E7%BD%AE%E4%B9%8B-%E4%B8%BA%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E7%AB%99%E5%86%85%E6%90%9C%E7%B4%A2/"/>
    <id>http://lulee007.gitcafe.io/2016/01/23/Hexo博客优化配置之-为自己博客添加站内搜索/</id>
    <published>2016-01-23T09:55:14.000Z</published>
    <updated>2016-01-24T07:10:26.000Z</updated>
    <content type="html"><![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>在配置 Hexo 博客期间根据参考了很多网上的方法，进行站内搜索集成结果都不太满意：</p>
<ol>
<li>百度<br>搜索都是以在检索的时候加入<code>site:www.xxx.com</code> 方式进行搜索，体验不是很好<br>而且百度这种搜索方式是你提交的 sitemap 链接到百度站内搜索收录才能在搜索结果中显示出来，结果我在测试的时候，<br>使用 github 和 gitcafe 进行测试时，发现百度都抓取不了这两个网站的数据了。只能作罢，在我的另一篇文章中有亲测结果，<a href="/2016/01/16/Hexo%E5%8D%9A%E5%AE%A2%E4%BC%98%E5%8C%96%E9%85%8D%E7%BD%AE%E4%B9%8B-%E4%B8%BA%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E7%BD%91%E9%A1%B5%E6%94%B6%E5%BD%95/">Hexo博客优化配置之–为自己博客添加搜索引擎网页收录</a>。</li>
<li>Hexo 自带的 Google Search<br>这种和百度的搜索类似，检索的时候加入<code>site:www.xxx.com</code> 方式进行搜索，用起来不爽。</li>
<li>Swiftype<br>先后参考了<a href="http://www.jerryfu.net/post/search-engine-for-hexo-with-swiftype.html" target="_blank" rel="external">jerryfu: 利用swiftype为hexo添加站内搜索</a><br>和<a href="http://blog.moyizhou.cn/web/search-engine-for-static-pages/#swiftype" target="_blank" rel="external">Rimo: 静态博客如何实现站内搜索</a>以及<br><a href="http://guoyuxiang.com/2015/07/27/%E5%9F%BA%E4%BA%8Eswiftype%E5%BA%94%E7%94%A8%E4%BA%8EHexo-Yilia-%E4%B8%BB%E9%A2%98%E7%9A%84%E7%AB%99%E5%86%85%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/" target="_blank" rel="external">Mjolnir: 基于swiftype应用于Hexo Yilia 主题的站内搜索引擎</a> 的文章，<br>但是很奇怪，总觉得 swiftype 的接口不太稳定，在上面提到的这些博客中，只有Rimo的博客站内搜索是可<br>用的，其他的弹出来的搜索结果都是空白，我自己的博客里集成后测试也是空白，只好作罢。</li>
<li>在 Google 搜索时，输入了<code>site:lulee007.gitcafe.io</code> 意外发现 Google 的另外一个产品 <code>Google Console</code><br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160123-2%402x.png" alt="google console"><br>然后在配置 Google Console 的过程中发现了 Google 提供的<em>自定义搜索</em>，经过配置后发现挺好用（其实还是要先上得了 Google）。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160123-3%402x.png" alt="自定义搜索"><a id="more"></a>
</li>
</ol>
<h2 id="u521B_u5EFA_u7F51_u7AD9_u641C_u7D22_u5F15_u64CE"><a href="#u521B_u5EFA_u7F51_u7AD9_u641C_u7D22_u5F15_u64CE" class="headerlink" title="创建网站搜索引擎"></a>创建网站搜索引擎</h2><p>打开<a href="https://cse.google.com/cse/all?hl=zh-CN" target="_blank" rel="external">Google 自定义搜索</a><br>然后在点击左侧的<code>新增搜索引擎</code>，填写必要的信息：</p>
<ul>
<li><code>要搜索的网站</code>-&gt;<code>http://lulee007.gitcafe.io/*</code><br>可选的有<code>选择语言</code>和修改<code>搜索引擎名称</code>，最后点<code>创建</code>。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160123-5%402x.png" alt="create search engine for web"><br>创建好之后提示：<blockquote>
<p>恭喜！<br>您已成功创建自定义搜索引擎。  </p>
</blockquote>
</li>
</ul>
<p><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160123-7%402x.png" alt="create engine success "></p>
<h2 id="u914D_u7F6E_u9002_u5408_Yilia__u4E3B_u9898_u7684_u7AD9_u5185_u641C_u7D22"><a href="#u914D_u7F6E_u9002_u5408_Yilia__u4E3B_u9898_u7684_u7AD9_u5185_u641C_u7D22" class="headerlink" title="配置适合 Yilia 主题的站内搜索"></a>配置适合 Yilia 主题的站内搜索</h2><h3 id="u914D_u7F6E_u641C_u7D22_u5F15_u64CE"><a href="#u914D_u7F6E_u641C_u7D22_u5F15_u64CE" class="headerlink" title="配置搜索引擎"></a>配置搜索引擎</h3><h4 id="u914D_u7F6E_u641C_u7D22_u5F15_u64CE_u5E03_u5C40"><a href="#u914D_u7F6E_u641C_u7D22_u5F15_u64CE_u5E03_u5C40" class="headerlink" title="配置搜索引擎布局"></a>配置搜索引擎布局</h4><p>点击第三个按钮，选择<code>控制台</code>对创建好的搜索引擎进行配置，进入控制台后点击左边的侧边栏中的<code>外观</code>，<br>配置搜索引擎布局并选择第二个<code>两页</code>，这样会在同一窗口中显示某一网页上的搜索框以及另一网页上的搜索结果。<br>点击<code>保存并获取代码</code>。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160123-8%402x.png" alt="setting search engine"><br><em>提示：</em> 如果不希望搜索结果里带缩略图，点击<code>缩略图</code>，然后选择关闭即可：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160123-9%402x.png" alt="show search web thumbnail"></p>
<h4 id="u83B7_u53D6_u641C_u7D22_u6846_u4EE3_u7801"><a href="#u83B7_u53D6_u641C_u7D22_u6846_u4EE3_u7801" class="headerlink" title="获取搜索框代码"></a>获取搜索框代码</h4><p>点击<code>保存并获取代码</code>后进入设置<code>获取搜索框的代码</code>步骤，点击标题旁边的<code>搜索结果详情</code>，在弹出来的页面来指定搜索结果详情页的完整地址:<code>http://lulee007.github.io/search</code>，然后点保存，接着复制搜索框代码：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cx = <span class="string">'015410210664254622126:e2mln2jl_yg'</span>;</span><br><span class="line">    <span class="keyword">var</span> gcse = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    gcse.type = <span class="string">'text/javascript'</span>;</span><br><span class="line">    gcse.async = <span class="literal">true</span>;</span><br><span class="line">    gcse.src = (<span class="built_in">document</span>.location.protocol == <span class="string">'https:'</span> ? <span class="string">'https:'</span> : <span class="string">'http:'</span>) +</span><br><span class="line">        <span class="string">'//cse.google.com/cse.js?cx='</span> + cx;</span><br><span class="line">    <span class="keyword">var</span> s = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'script'</span>)[<span class="number">0</span>];</span><br><span class="line">    s.parentNode.insertBefore(gcse, s);</span><br><span class="line">  &#125;)();</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">gcse:searchbox-only</span>&gt;</span><span class="tag">&lt;/<span class="title">gcse:searchbox-only</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>临时保存起来，待会会用到。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160123-11%402x.png" alt="setting search page url"></p>
<h4 id="u83B7_u53D6_u641C_u7D22_u7ED3_u679C_u4EE3_u7801"><a href="#u83B7_u53D6_u641C_u7D22_u7ED3_u679C_u4EE3_u7801" class="headerlink" title="获取搜索结果代码"></a>获取搜索结果代码</h4><p>在点击<code>下一步：获取搜索结果代码</code>后，复制里面的代码：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cx = <span class="string">'015410210664254622126:e2mln2jl_yg'</span>;</span><br><span class="line">    <span class="keyword">var</span> gcse = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    gcse.type = <span class="string">'text/javascript'</span>;</span><br><span class="line">    gcse.async = <span class="literal">true</span>;</span><br><span class="line">    gcse.src = (<span class="built_in">document</span>.location.protocol == <span class="string">'https:'</span> ? <span class="string">'https:'</span> : <span class="string">'http:'</span>) +</span><br><span class="line">        <span class="string">'//cse.google.com/cse.js?cx='</span> + cx;</span><br><span class="line">    <span class="keyword">var</span> s = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'script'</span>)[<span class="number">0</span>];</span><br><span class="line">    s.parentNode.insertBefore(gcse, s);</span><br><span class="line">  &#125;)();</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">gcse:searchresults-only</span>&gt;</span><span class="tag">&lt;/<span class="title">gcse:searchresults-only</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="u4FEE_u6539_Yilia__u4E3B_u9898"><a href="#u4FEE_u6539_Yilia__u4E3B_u9898" class="headerlink" title="修改 Yilia 主题"></a>修改 Yilia 主题</h3><h4 id="u6DFB_u52A0_u641C_u7D22_u6309_u94AE"><a href="#u6DFB_u52A0_u641C_u7D22_u6309_u94AE" class="headerlink" title="添加搜索按钮"></a>添加搜索按钮</h4><p>打开<code>themes/yilia/layout/_partial/left-col.ejs</code>文件，在<code>&lt;% if (theme.subtitle){ %&gt;...&lt;%}%&gt;</code>后面添加刚才保存的<em>搜索框代码</em>：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">%</span> <span class="attribute">if</span> (<span class="attribute">theme.subtitle</span>)&#123; %&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">p</span> <span class="attribute">class</span>=<span class="value">"header-subtitle"</span>&gt;</span><span class="tag">&lt;<span class="title">%=theme.subtitle%</span>&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">%&#125;%</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 以下是新增的搜索框代码--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cx = <span class="string">'015410210664254622126:e2mln2jl_yg'</span>;</span><br><span class="line">    <span class="keyword">var</span> gcse = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    gcse.type = <span class="string">'text/javascript'</span>;</span><br><span class="line">    gcse.async = <span class="literal">true</span>;</span><br><span class="line">    gcse.src = (<span class="built_in">document</span>.location.protocol == <span class="string">'https:'</span> ? <span class="string">'https:'</span> : <span class="string">'http:'</span>) +</span><br><span class="line">        <span class="string">'//cse.google.com/cse.js?cx='</span> + cx;</span><br><span class="line">    <span class="keyword">var</span> s = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'script'</span>)[<span class="number">0</span>];</span><br><span class="line">    s.parentNode.insertBefore(gcse, s);</span><br><span class="line">  &#125;)();</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">gcse:searchbox-only</span>&gt;</span><span class="tag">&lt;/<span class="title">gcse:searchbox-only</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="u914D_u7F6E_u641C_u7D22_u9875"><a href="#u914D_u7F6E_u641C_u7D22_u9875" class="headerlink" title="配置搜索页"></a>配置搜索页</h4><p>打开终端，然后转到博客的根目录下执行新建 page 操作：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page search</span><br></pre></td></tr></table></figure></p>
<p>这个 page 用来做搜索结果页。打开 search 目录下的 <code>index.md</code>输入下面的代码：<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">title: 搜索结果</span><br><span class="line">comments: false</span><br><span class="line">layout: 'page'</span><br><span class="line"><span class="header">toc: false</span><br><span class="line">---</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="undefined"></span></span></span><br><span class="line">  (function() &#123;</span><br><span class="line"><span class="code">    var cx = '015410210664254622126:iaoif_30spo';</span></span><br><span class="line"><span class="code">    var gcse = document.createElement('script');</span></span><br><span class="line"><span class="code">    gcse.type = 'text/javascript';</span></span><br><span class="line"><span class="code">    gcse.async = true;</span></span><br><span class="line"><span class="code">    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +</span></span><br><span class="line"><span class="code">        '//cse.google.com/cse.js?cx=' + cx;</span></span><br><span class="line"><span class="code">    var s = document.getElementsByTagName('script')[0];</span></span><br><span class="line"><span class="code">    s.parentNode.insertBefore(gcse, s);</span></span><br><span class="line">  &#125;)();</span><br><span class="line"><span class="xml"><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">gcse:searchresults-only</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="title">gcse:searchresults-only</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<h4 id="u914D_u7F6E_u641C_u7D22_u7ED3_u679C_u6837_u5F0F"><a href="#u914D_u7F6E_u641C_u7D22_u7ED3_u679C_u6837_u5F0F" class="headerlink" title="配置搜索结果样式"></a>配置搜索结果样式</h4><p>由于 Google Search 提供的默认样式太难看了，自己手动修改了一些。<br>打开 Yilia 主题下的<code>source/css/style.styl</code>文件，在文件末尾添加如下代码：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//google search</span><br><span class="line">.gsc-resultsHeader &#123;</span><br><span class="line">  display: none !important;</span><br><span class="line">&#125;</span><br><span class="line">.gsc-result .gs-title &#123;</span><br><span class="line">  height: 1.5em !important;</span><br><span class="line">&#125;</span><br><span class="line">.gsc-webResult .gsc-result &#123;</span><br><span class="line">  padding: 0px 0 16px 0 !important;</span><br><span class="line">&#125;</span><br><span class="line">.article-entry table &#123;</span><br><span class="line">  margin: 0px 0 !important;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="u90E8_u7F72_u6D4B_u8BD5"><a href="#u90E8_u7F72_u6D4B_u8BD5" class="headerlink" title="部署测试"></a>部署测试</h2><p>生成 html 文件并部署到网站上：<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="keyword">d</span> -<span class="keyword">g</span></span><br></pre></td></tr></table></figure></p>
<p><strong>注意：</strong> 请确保能访问的了 Google ，不然搜索框加载不了，自然也搜索不到结果。<br>打开博客，这是在左侧边栏应该可以看到 Google 自定义搜索框和按钮，输入测试词 <code>hexo</code>进行检索。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160124-0%402x.png" alt="google search bar"><br>我这里使用已经配置好的 gitcafe 上的博客进行了演示，<br>敲回车后，应该会打开博客的新的网页<code>http://lulee007.gitcafe.io/search/index.html?q=hexo</code><br>展示搜索到的结果了。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160124-1%402x.png" alt="search result"></p>
<h2 id="u6700_u540E"><a href="#u6700_u540E" class="headerlink" title="最后"></a>最后</h2><p>如果检索不到内容，可能需要配合 Google Console 进行提交 站点地图，让 Google 对博客 sitemap 进行抓取<br>内容之后才行。可以在 Google 搜索 <code>site:lulee007.gitcafe.io</code> 测试能不能检索到你的博客，<br>把<code>lulee007.gitcafe.io</code>替换为你自己的博客。</p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>在配置 Hexo 博客期间根据参考了很多网上的方法，进行站内搜索集成结果都不太满意：</p>
<ol>
<li>百度<br>搜索都是以在检索的时候加入<code>site:www.xxx.com</code> 方式进行搜索，体验不是很好<br>而且百度这种搜索方式是你提交的 sitemap 链接到百度站内搜索收录才能在搜索结果中显示出来，结果我在测试的时候，<br>使用 github 和 gitcafe 进行测试时，发现百度都抓取不了这两个网站的数据了。只能作罢，在我的另一篇文章中有亲测结果，<a href="/2016/01/16/Hexo%E5%8D%9A%E5%AE%A2%E4%BC%98%E5%8C%96%E9%85%8D%E7%BD%AE%E4%B9%8B-%E4%B8%BA%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E7%BD%91%E9%A1%B5%E6%94%B6%E5%BD%95/">Hexo博客优化配置之–为自己博客添加搜索引擎网页收录</a>。</li>
<li>Hexo 自带的 Google Search<br>这种和百度的搜索类似，检索的时候加入<code>site:www.xxx.com</code> 方式进行搜索，用起来不爽。</li>
<li>Swiftype<br>先后参考了<a href="http://www.jerryfu.net/post/search-engine-for-hexo-with-swiftype.html">jerryfu: 利用swiftype为hexo添加站内搜索</a><br>和<a href="http://blog.moyizhou.cn/web/search-engine-for-static-pages/#swiftype">Rimo: 静态博客如何实现站内搜索</a>以及<br><a href="http://guoyuxiang.com/2015/07/27/%E5%9F%BA%E4%BA%8Eswiftype%E5%BA%94%E7%94%A8%E4%BA%8EHexo-Yilia-%E4%B8%BB%E9%A2%98%E7%9A%84%E7%AB%99%E5%86%85%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/">Mjolnir: 基于swiftype应用于Hexo Yilia 主题的站内搜索引擎</a> 的文章，<br>但是很奇怪，总觉得 swiftype 的接口不太稳定，在上面提到的这些博客中，只有Rimo的博客站内搜索是可<br>用的，其他的弹出来的搜索结果都是空白，我自己的博客里集成后测试也是空白，只好作罢。</li>
<li>在 Google 搜索时，输入了<code>site:lulee007.gitcafe.io</code> 意外发现 Google 的另外一个产品 <code>Google Console</code><br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160123-2%402x.png" alt="google console"><br>然后在配置 Google Console 的过程中发现了 Google 提供的<em>自定义搜索</em>，经过配置后发现挺好用（其实还是要先上得了 Google）。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160123-3%402x.png" alt="自定义搜索">]]>
    
    </summary>
    
      <category term="Hexo" scheme="http://lulee007.gitcafe.io/tagsCN/Hexo/"/>
    
      <category term="站内搜索" scheme="http://lulee007.gitcafe.io/tagsCN/%E7%AB%99%E5%86%85%E6%90%9C%E7%B4%A2/"/>
    
      <category term="技术" scheme="http://lulee007.gitcafe.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Mac下重置Mysql的root密码]]></title>
    <link href="http://lulee007.gitcafe.io/2016/01/18/Mac%E4%B8%8B%E9%87%8D%E7%BD%AEMysql%E7%9A%84root%E5%AF%86%E7%A0%81/"/>
    <id>http://lulee007.gitcafe.io/2016/01/18/Mac下重置Mysql的root密码/</id>
    <published>2016-01-18T13:18:36.000Z</published>
    <updated>2016-01-19T00:36:52.000Z</updated>
    <content type="html"><![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>Mac上装了Mysql很长时间了，结果每次用的时候发现密码都不对上，密码忘了，这次长记性了，记下来。<br><a href="http://www.zuimoban.com/jiaocheng/mysql/2548.html" target="_blank" rel="external">参考:mac上安装mysql 以及root密码忘记或权限错误的解决办法</a></p>
<a id="more"></a>
<h2 id="u914D_u7F6Emysql_u73AF_u5883_u53D8_u91CF"><a href="#u914D_u7F6Emysql_u73AF_u5883_u53D8_u91CF" class="headerlink" title="配置mysql环境变量"></a>配置mysql环境变量</h2><p>在终端中输入：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo vi ~/bash_profile</span><br><span class="line"><span class="comment"># 按`i`键进入编辑模式</span></span><br></pre></td></tr></table></figure></p>
<p>输入以下内容到文件最后:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mysql</span></span><br><span class="line"><span class="built_in">alias</span> mysql=<span class="string">'/usr/local/mysql/bin/mysql'</span></span><br><span class="line"><span class="built_in">alias</span> mysqladmin=<span class="string">'/usr/local/mysql/bin/mysqladmin'</span></span><br><span class="line"><span class="comment"># 按`esc`键，然后输入`wq`回车，即可保存退出。</span></span><br></pre></td></tr></table></figure></p>
<p>一般出现的错误如下：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ERROR <span class="number">1045</span> (<span class="number">28000</span>): Access denied <span class="keyword">for</span> user <span class="string">'root'</span>@<span class="string">'localhost'</span> (using password: NO)</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">ERROR <span class="number">1045</span> (<span class="number">28000</span>): Access denied <span class="keyword">for</span> user <span class="string">'root'</span>@<span class="string">'localhost'</span> (using password: YES)</span><br></pre></td></tr></table></figure></p>
<h2 id="u89E3_u51B3_u65B9_u6CD5"><a href="#u89E3_u51B3_u65B9_u6CD5" class="headerlink" title="解决方法"></a>解决方法</h2><ol>
<li>停止 mysql server<br>通常是在 ‘系统偏好设置’ &gt; MySQL &gt; ‘Stop MySQL Server’  </li>
<li><p>打开终端，输入：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/<span class="keyword">local</span>/mysql/bin/mysqld_safe <span class="comment">--skip-grant-tables</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>打开<strong>另一个新终端</strong>，输入:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/<span class="built_in">local</span>/mysql/bin/mysql -u root</span><br><span class="line"><span class="comment"># 输入 Mac 系统用户密码后，</span></span><br><span class="line"><span class="comment"># 直接敲回车进入 mysql 终端，输入：</span></span><br><span class="line">UPDATE mysql.user SET authentication_string=PASSWORD(<span class="string">'新密码'</span>) WHERE User=<span class="string">'root'</span>;</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line"><span class="comment"># 输入 \q 退出 mysql 终端</span></span><br><span class="line">\q</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启MySQL.</p>
</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>Mac上装了Mysql很长时间了，结果每次用的时候发现密码都不对上，密码忘了，这次长记性了，记下来。<br><a href="http://www.zuimoban.com/jiaocheng/mysql/2548.html">参考:mac上安装mysql 以及root密码忘记或权限错误的解决办法</a></p>]]>
    
    </summary>
    
      <category term="Mac" scheme="http://lulee007.gitcafe.io/tagsCN/Mac/"/>
    
      <category term="Mysql" scheme="http://lulee007.gitcafe.io/tagsCN/Mysql/"/>
    
      <category term="root" scheme="http://lulee007.gitcafe.io/tagsCN/root/"/>
    
      <category term="重置密码" scheme="http://lulee007.gitcafe.io/tagsCN/%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/"/>
    
      <category term="技术" scheme="http://lulee007.gitcafe.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hexo博客优化配置之--为自己博客添加搜索引擎网页收录]]></title>
    <link href="http://lulee007.gitcafe.io/2016/01/16/Hexo%E5%8D%9A%E5%AE%A2%E4%BC%98%E5%8C%96%E9%85%8D%E7%BD%AE%E4%B9%8B-%E4%B8%BA%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E7%BD%91%E9%A1%B5%E6%94%B6%E5%BD%95/"/>
    <id>http://lulee007.gitcafe.io/2016/01/16/Hexo博客优化配置之-为自己博客添加搜索引擎网页收录/</id>
    <published>2016-01-16T07:55:14.000Z</published>
    <updated>2016-01-18T01:44:05.000Z</updated>
    <content type="html"><![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>从今年的一月七号开始，这个 Hexo 博客折腾了差不多十天，在使用 Yilia 这个主题过程中，发现有些地方不太满意,就把源码 fork<br>下来一版本自己进行折腾。 在折腾这个站内搜索的功能时间最长， 看了网上的一些教程，没有一个搞的顺的。最后自己看着官方文档进行<br>了尝试，将就着搞的差不多了:<br><a href="/">Hexo博客优化配置之–为自己博客添加站内搜索</a><br>为了让博客内容尽可能的被<strong>百度</strong>或者<strong>谷歌</strong>搜索到,需要将自己的博客上的博客链接添加到搜索引擎收录中。<br><strong>提醒:</strong> 如果你的博客在 github.io 上，想添加百度收录的直接 pass 吧。  </p>
<a id="more"></a>
<h2 id="u767E_u5EA6"><a href="#u767E_u5EA6" class="headerlink" title="百度"></a>百度</h2><p><strong>注意：</strong> 经过测试发现 gitcafe 也<em>不能够进行抓取</em>了，以下内容仅是记录当时的尝试过程。</p>
<h3 id="u94FE_u63A5_u63D0_u4EA4_u65B9_u5F0F_u5B9E_u6D4B"><a href="#u94FE_u63A5_u63D0_u4EA4_u65B9_u5F0F_u5B9E_u6D4B" class="headerlink" title="链接提交方式实测"></a>链接提交方式实测</h3><blockquote>
<p>如何选择链接提交方式<br>1、主动推送：最为快速的提交方式，推荐您将站点当天新产出链接立即通过此方式推送给百度，以保证新链接可以及时被百度收录。<br>2、自动推送：最为便捷的提交方式，请将自动推送的JS代码部署在站点的每一个页面源代码中，部署代码的页面在每次被浏览时，链接会被自动推送给百度。可以与主动推送配合使用。<br>3、sitemap：您可以定期将网站链接放到sitemap中，然后将sitemap提交给百度。百度会周期性的抓取检查您提交的sitemap，对其中的链接进行处理，但收录速度慢于主动推送。<br>4、手动提交：一次性提交链接给百度，可以使用此种方式。<br><em>百度站长平台为站长提供链接提交通道，您可以提交想被百度收录的链接，百度搜索引擎会按照标准处理，但不保证一定能够收录您提交的链接。</em></p>
</blockquote>
<p>最新的链接提交入口在<a href="http://zhanzhang.baidu.com/" target="_blank" rel="external">百度站长平台</a>&gt;&gt;<code>工具</code>板块左侧菜单栏下选择:<code>网页抓取</code>&gt;&gt;<code>链接提交</code>:<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160116-0%402x.png" alt="链接提交"></p>
<h4 id="sitemap"><a href="#sitemap" class="headerlink" title="sitemap"></a>sitemap</h4><p>因为图个方便,在安装了<a href="https://github.com/coneycode/hexo-generator-baidu-sitemap" target="_blank" rel="external">百度 sitemap</a>后直接生成了适合百度的 sitemap ,所以就最先尝试了这个<code>sitemap</code>方式.<br>结果等了两天也没看状态更新过,一直是等待状态,太2了,是不是故意的.<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160116-1%402x.png" alt="等待"></p>
<h4 id="u81EA_u52A8_u63A8_u9001"><a href="#u81EA_u52A8_u63A8_u9001" class="headerlink" title="自动推送"></a>自动推送</h4><p>这个简单,直接拷贝代码,放到网页中. 然并卵(笑哭)<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> bp = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    bp.src = <span class="string">'//push.zhanzhang.baidu.com/push.js'</span>;</span><br><span class="line">    <span class="keyword">var</span> s = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"script"</span>)[<span class="number">0</span>];</span><br><span class="line">    s.parentNode.insertBefore(bp, s);</span><br><span class="line">&#125;)();</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="u624B_u52A8_u63D0_u4EA4"><a href="#u624B_u52A8_u63D0_u4EA4" class="headerlink" title="手动提交"></a>手动提交</h4><p>这个简单直接把sitemap里的网址整理出来按照要求上传即可</p>
<h3 id="u4E3B_u52A8_u63A8_u9001"><a href="#u4E3B_u52A8_u63A8_u9001" class="headerlink" title="主动推送"></a>主动推送</h3><p>最后试试看主动推送这里参考<a href="http://lovenight.github.io/2015/11/18/%E5%90%91%E7%99%BE%E5%BA%A6%E6%8E%A8%E9%80%81hexo%E5%8D%9A%E5%AE%A2%E6%89%80%E6%9C%89%E9%93%BE%E6%8E%A5%E7%9A%84Python%E8%84%9A%E6%9C%AC/" target="_blank" rel="external">lovenight 的向百度推送hexo博客所有链接的Python脚本</a><br>不太懂 python ,在 mac 下对 python 脚本进行了简单的修改:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Author: LoveNight</span></span><br><span class="line"><span class="comment"># @Date:   2015-11-16 20:45:59</span></span><br><span class="line"><span class="comment"># @Last Modified by:   lulee007</span></span><br><span class="line"><span class="comment"># @Last Modified time: 2016-01-16 21:06:50</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup <span class="keyword">as</span> BS</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span><br><span class="line">hexo 博客专用，向百度站长平台提交所有网址</span><br><span class="line"></span><br><span class="line">本脚本必须放在hexo博客的根目录下执行！需要已安装生成百度站点地图的插件。</span><br><span class="line">百度站长平台提交链接：http://zhanzhang.baidu.com/linksubmit/index</span><br><span class="line">主动推送：最为快速的提交方式，推荐您将站点当天新产出链接立即通过此方式推送给百度，以保证新链接可以及时被百度收录。</span><br><span class="line">从中找到自己的接口调用地址</span><br><span class="line">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://data.zz.baidu.com/urls?site=YOUR_BLOG_HOST&amp;token=YOUR_TOKEN'</span></span><br><span class="line">baidu_sitemap = os.path.join(sys.path[<span class="number">0</span>], <span class="string">'public'</span>, <span class="string">'baidusitemap.xml'</span>)</span><br><span class="line">google_sitemap = os.path.join(sys.path[<span class="number">0</span>], <span class="string">'public'</span>, <span class="string">'sitemap.xml'</span>)</span><br><span class="line"><span class="comment"># sitemap = [baidu_sitemap, google_sitemap]</span></span><br><span class="line">sitemap = [baidu_sitemap]</span><br><span class="line"></span><br><span class="line"><span class="comment"># assert (os.path.exists(baidu_sitemap) or os.path.exists(</span></span><br><span class="line"><span class="comment">#     google_sitemap)), "没找到任何网站地图，请检查！"</span></span><br><span class="line"><span class="keyword">assert</span> os.path.exists(baidu_sitemap) , <span class="string">"没找到任何网站地图，请检查！"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从站点地图中读取网址列表</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUrls</span><span class="params">()</span>:</span></span><br><span class="line">    urls = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> sitemap:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(_):</span><br><span class="line">            <span class="keyword">with</span> codecs.open(_, <span class="string">"r"</span>, <span class="string">"utf-8"</span>) <span class="keyword">as</span> f:</span><br><span class="line">                xml = f.read()</span><br><span class="line">            soup = BS(xml, <span class="string">"xml"</span>)</span><br><span class="line">            tags = soup.find_all(<span class="string">"loc"</span>)</span><br><span class="line">            urls += [x.string <span class="keyword">for</span> x <span class="keyword">in</span> tags]</span><br><span class="line">            <span class="keyword">if</span> _ == baidu_sitemap:</span><br><span class="line">                tags = soup.find_all(<span class="string">"breadCrumb"</span>, url=<span class="keyword">True</span>)</span><br><span class="line">                print(<span class="string">""</span>)</span><br><span class="line">                urls += [x[<span class="string">"url"</span>] <span class="keyword">for</span> x <span class="keyword">in</span> tags]</span><br><span class="line">    <span class="keyword">return</span> urls</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># POST提交网址列表</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">postUrls</span><span class="params">(urls)</span>:</span></span><br><span class="line">    urls = set(urls)  <span class="comment"># 先去重</span></span><br><span class="line">    print(<span class="string">"一共提取出 %s 个网址"</span> % len(urls))</span><br><span class="line">    data = <span class="string">"\n"</span>.join(urls)</span><br><span class="line">    <span class="keyword">return</span> requests.post(url, data=data).text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line">    urls = getUrls()</span><br><span class="line">    result = postUrls(urls)</span><br><span class="line">    print(<span class="string">"提交结果："</span>)</span><br><span class="line">    print(result)</span><br><span class="line">```    </span><br><span class="line">如果你也是在 mac 下配置, 直接替换其中的`YOUR_BLOG_HOST`和`YOUR_TOKEN`然后运行此脚本即可得到类似的结果:</span><br></pre></td></tr></table></figure></p>
<p>一共提取出 11 个网址<br>提交结果：<br>{“remain”:478,”success”:11}<br><code>``
第二天看一下提交情况:
![提交结果](http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160117-0%402x.png)
但是在百度进行搜索时</code>site:lulee007.gitcafe.io`,还是只能看到一条。<br>最后想想是不是也不能抓取gitcafe了，进行了诊断。<br><strong><em>诊断:</em></strong>然后看到侧边栏还提供了抓取诊断工具，然后进行诊断一下吧，就输入了博客的其中一个链接:<br>呵呵了:<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160116-2%402x.png" alt="诊断结果"><br>dns 解析失败，这也抓不了 gitcafe ?  </p>
<p><strong><em>白忙活了(无耐啊)</em></strong></p>
<h2 id="u8C37_u6B4C"><a href="#u8C37_u6B4C" class="headerlink" title="谷歌"></a>谷歌</h2><h3 id="u6DFB_u52A0_u4E00_u4E2A_u8D44_u6E90_u7AD9"><a href="#u6DFB_u52A0_u4E00_u4E2A_u8D44_u6E90_u7AD9" class="headerlink" title="添加一个资源站"></a>添加一个资源站</h3><p>打开<a href="https://www.google.com/webmasters/tools/home?hl=zh-CN&amp;authuser=0" target="_blank" rel="external">google console</a>然后右上角有个<code>添加属性</code>按钮。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160117-1%402x.png" alt="添加属性"><br>输入博客地址<code>lulee007.github.io</code>，我这里用 github 的地址测试。<br>点击<code>继续</code>后，会提示验证网站的所有权，<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160117-2%402x.png" alt="推荐方法"><br>这里采用备用的方法：<code>HTML标记</code><br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160117-3%402x.png" alt="HTML标记"><br>验证成功后结果：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160117-4%402x.png" alt="验证通过结果"></p>
<h3 id="u6DFB_u52A0_u7AD9_u70B9_u5730_u56FE"><a href="#u6DFB_u52A0_u7AD9_u70B9_u5730_u56FE" class="headerlink" title="添加站点地图"></a>添加站点地图</h3><p>这时打开上面的链接<code>Search Console</code>，或者通过资源列表页查看刚才添加的资源：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160117-5%402x.png" alt="资源列表项"><br>点击<code>lulee007.github.io</code>标题就可以进入管理页。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160117-6%402x.png" alt="管理概览"><br>在左边的侧边栏依次选择<code>抓取</code>&gt;&gt;<code>站点地图</code>，然后选择右边的<code>添加/测试站点地图</code>:<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_1.jpg" alt="添加站点地图"><br>添加后：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160118-0%402x.png" alt="已添加站点一览"><br>这就完成了，等待一段时间后待谷歌进行抓取就可以，一般第二天看到结果了。<br>这时我第二天在谷歌搜索得到的结果：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160118-1%402x.png" alt="搜索结果"><br>搜索的结果很准确，比百度强很多。</p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>从今年的一月七号开始，这个 Hexo 博客折腾了差不多十天，在使用 Yilia 这个主题过程中，发现有些地方不太满意,就把源码 fork<br>下来一版本自己进行折腾。 在折腾这个站内搜索的功能时间最长， 看了网上的一些教程，没有一个搞的顺的。最后自己看着官方文档进行<br>了尝试，将就着搞的差不多了:<br><a href="/">Hexo博客优化配置之–为自己博客添加站内搜索</a><br>为了让博客内容尽可能的被<strong>百度</strong>或者<strong>谷歌</strong>搜索到,需要将自己的博客上的博客链接添加到搜索引擎收录中。<br><strong>提醒:</strong> 如果你的博客在 github.io 上，想添加百度收录的直接 pass 吧。  </p>]]>
    
    </summary>
    
      <category term="Hexo" scheme="http://lulee007.gitcafe.io/tagsCN/Hexo/"/>
    
      <category term="百度搜索链接收录" scheme="http://lulee007.gitcafe.io/tagsCN/%E7%99%BE%E5%BA%A6%E6%90%9C%E7%B4%A2%E9%93%BE%E6%8E%A5%E6%94%B6%E5%BD%95/"/>
    
      <category term="谷歌搜索链接收录" scheme="http://lulee007.gitcafe.io/tagsCN/%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2%E9%93%BE%E6%8E%A5%E6%94%B6%E5%BD%95/"/>
    
      <category term="笔记" scheme="http://lulee007.gitcafe.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[SSM：Struts2+Spring+Mybatis Web 项目搭建]]></title>
    <link href="http://lulee007.gitcafe.io/2016/01/14/SSM-Struts2-Spring-Mybatis-Jersey-Web-%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA/"/>
    <id>http://lulee007.gitcafe.io/2016/01/14/SSM-Struts2-Spring-Mybatis-Jersey-Web-项目搭建/</id>
    <published>2016-01-14T11:55:14.000Z</published>
    <updated>2016-01-22T06:48:48.000Z</updated>
    <content type="html"><![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>在 Intellij 中配置 SSM Web 开发框架。</p>
<ul>
<li>Struts2 主要用它的视图统筹</li>
<li>Spring 整个框架的统筹</li>
<li>Mybatis3 持久层,MyBatis 是支持定制化SQL、存储过程以及高级映射的优秀的持久层框架</li>
</ul>
<p>参考：<a href="http://blog.csdn.net/u011403655/article/details/46843331" target="_blank" rel="external">夕下奕林:Idea SpringMVC+Spring+MyBatis+Maven整合</a><br><a id="more"></a></p>
<h2 id="u9879_u76EE_u521B_u5EFA"><a href="#u9879_u76EE_u521B_u5EFA" class="headerlink" title="项目创建"></a>项目创建</h2><h3 id="u521B_u5EFA_u65B0_u7684Maven_WebApp_u9879_u76EE"><a href="#u521B_u5EFA_u65B0_u7684Maven_WebApp_u9879_u76EE" class="headerlink" title="创建新的Maven WebApp项目"></a>创建新的<code>Maven WebApp</code>项目</h3><p>打开Intellij 选择<code>File</code>-&gt;<code>New</code>-&gt;<code>Project...</code><br>然后在弹出对话框里依次选择：<br>左侧的<code>Maven</code>，顶部的<code>Create from archetype</code>和右侧的<code>org.apache.maven.archetypes:maven-archetype-webapp</code><br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160119-0%402x.png" alt="选择maven项目">  </p>
<p>点击<code>Next</code>，输入<code>GroupId</code>和<code>ArtifaceId</code><br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160119-1%402x.png" alt="输入 GroupId 与 ArtifaceId"></p>
<p>点击<code>Next</code>，这里主要是 Maven的环境配置，使用默认<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160119-2%402x.png" alt="Maven 默认环境"></p>
<p>点击<code>Next</code>，输入工程名称(<code>Project Name</code>)，修改保存目录(<code>Project Location</code>)<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160119-3%402x.png" alt="保存工程"></p>
<p><strong>注意：</strong> 如果选择的工程不存在，Intellij会提示自动创建该目录。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160119-4%402x.png" alt="创建目录提示"></p>
<h3 id="u914D_u7F6E_u9879_u76EE_u76EE_u5F55"><a href="#u914D_u7F6E_u9879_u76EE_u76EE_u5F55" class="headerlink" title="配置项目目录"></a>配置项目目录</h3><p>此时Intellij会进行初始化，Maven 会下载依赖基本项。<br>初始化完成后，项目结构差不多是这个样子：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160119-5%402x.png" alt="inited project"></p>
<p>在<code>src</code>-&gt;<code>main</code>目录下创建几个文件夹<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160119-6%402x.png" alt="creat folders"><br>打开 Intellij 底部标签栏的<code>Terminal</code>，并输入以下代码来批量创建目录：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p src<span class="regexp">/test/</span>java src<span class="regexp">/test/</span>resources</span><br><span class="line">cd src/main</span><br><span class="line">mkdir -p java<span class="regexp">/com/</span>lulee007<span class="regexp">/ssm/</span>pojo java<span class="regexp">/com/</span>lulee007<span class="regexp">/ssm/</span>mapper java<span class="regexp">/com/</span>lulee007<span class="regexp">/ssm/</span>service java<span class="regexp">/com/</span>lulee007<span class="regexp">/ssm/</span>action</span><br><span class="line">mkdir -p resources<span class="regexp">/config/</span>mybatis resources<span class="regexp">/config/</span>spring resources<span class="regexp">/config/</span>struts2 resources<span class="regexp">/com/</span>lulee007<span class="regexp">/ssm/</span>mapper</span><br><span class="line">mkdir webapp<span class="regexp">/WEB-INF/</span>views</span><br></pre></td></tr></table></figure></p>
<p>在<code>main</code>目录下的<code>java</code>目录上右击，选择<code>Mark Direcotry As</code>-&gt;<code>Sources Root</code><br>然后在<code>test</code>目录下的<code>java</code>目录上右击，选择<code>Mark Direcotry As</code>-&gt;<code>Test Sources Root</code><br>最后在<code>test</code>目录下的<code>resources</code>目录上右击，选择<code>Mark Direcotry As</code>-&gt;<code>Test Resources Root</code></p>
<h2 id="u914D_u7F6E_u9879_u76EE"><a href="#u914D_u7F6E_u9879_u76EE" class="headerlink" title="配置项目"></a>配置项目</h2><h3 id="u914D_u7F6E_u6570_u636E_u5E93_u8FDE_u63A5mysql_db-properties"><a href="#u914D_u7F6E_u6570_u636E_u5E93_u8FDE_u63A5mysql_db-properties" class="headerlink" title="配置数据库连接mysql_db.properties"></a>配置数据库连接mysql_db.properties</h3><p>先配置数据库连接，方便接下来的<code>Mybatis Generator</code>和Spring配置中使用，<br>在<code>main/resources/config</code>目录下创建文件<code>mysql_db.properties</code>输入下面的代码：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jdbc<span class="class">.driver</span> = com<span class="class">.mysql</span><span class="class">.jdbc</span><span class="class">.Driver</span>  </span><br><span class="line">jdbc<span class="class">.url</span> = jdbc:mysql:<span class="comment">//127.0.0.1:3306/mybatis?characterEncoding=UTF-8  </span></span><br><span class="line">jdbc<span class="class">.username</span> = root  </span><br><span class="line">jdbc<span class="class">.password</span> =</span><br></pre></td></tr></table></figure></p>
<h3 id="u914D_u7F6EMybatis_Generator"><a href="#u914D_u7F6EMybatis_Generator" class="headerlink" title="配置Mybatis Generator"></a>配置<code>Mybatis Generator</code></h3><p>使用mybatis-generator-maven-plugin插件来自动生成 model 和 mapper 文件<br>参考：<a href="http://blog.csdn.net/sunny243788557/article/details/45166397" target="_blank" rel="external"> Intellij IDEA 14中使用MyBatis-generator 自动生成MyBatis代码</a>  </p>
<ol>
<li><p>准备数据库User 表，结构如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`user`</span>;</span></span><br><span class="line"><span class="comment">/*!40101 SET @saved_cs_client     = @@character_set_client */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET character_set_client = utf8 */</span>;</span><br><span class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`user`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`username`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'用户名称'</span>,</span><br><span class="line">  <span class="string">`birthday`</span> <span class="built_in">date</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'生日'</span>,</span><br><span class="line">  <span class="string">`sex`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'性别'</span>,</span><br><span class="line">  <span class="string">`address`</span> <span class="built_in">varchar</span>(<span class="number">256</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'地址'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">27</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加插件到<code>pom.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">build</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">finalName</span>&gt;</span>ssm_demo<span class="tag">&lt;/<span class="title">finalName</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 以下是新增内容--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">plugins</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="title">plugin</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="title">configuration</span>&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="title">verbose</span>&gt;</span>true<span class="tag">&lt;/<span class="title">verbose</span>&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="title">overwrite</span>&gt;</span>true<span class="tag">&lt;/<span class="title">overwrite</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>配置<code>generatorConfig.xml</code>文件<br>在<code>src/main/resouces</code>目录下创建文件<code>generatorConfig.xml</code>，输入下面的内容：  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="doctype">&lt;!DOCTYPE generatorConfiguration</span><br><span class="line">        PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span><br><span class="line">        "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">generatorConfiguration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置连接数据库的jar --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">classPathEntry</span> <span class="attribute">location</span>=<span class="value">"F:\jar\mysql\mysql-connector-java-5.1.7-bin.jar"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">context</span> <span class="attribute">id</span>=<span class="value">"testTables"</span> <span class="attribute">targetRuntime</span>=<span class="value">"MyBatis3"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">commentGenerator</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 是否去除自动生成的注释 true：是 ： false:否 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"suppressAllComments"</span> <span class="attribute">value</span>=<span class="value">"false"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">commentGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--数据库连接的信息：驱动类、连接地址、用户名、密码 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;jdbcConnection driverClass="$&#123;jdbc.driver&#125;"--&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--connectionURL="$&#123;jdbc.url&#125;"--&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--userId="$&#123;jdbc.username&#125;"--&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--password="$&#123;jdbc.password&#125;"&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;/jdbcConnection&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">jdbcConnection</span> <span class="attribute">driverClass</span>=<span class="value">"com.mysql.jdbc.Driver"</span></span><br><span class="line">            <span class="attribute">connectionURL</span>=<span class="value">"jdbc:mysql://127.0.0.1:3306/mybatis?characterEncoding=UTF-8"</span></span><br><span class="line">            <span class="attribute">userId</span>=<span class="value">"root"</span></span><br><span class="line">            <span class="attribute">password</span>=<span class="value">""</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 默认false，把JDBC DECIMAL 和 NUMERIC 类型解析为 Integer，为 true时把JDBC DECIMAL 和</span><br><span class="line">            NUMERIC 类型解析为java.math.BigDecimal --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">javaTypeResolver</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"forceBigDecimals"</span> <span class="attribute">value</span>=<span class="value">"false"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">javaTypeResolver</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- targetProject:生成PO类的位置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">javaModelGenerator</span> <span class="attribute">targetPackage</span>=<span class="value">"com.lulee007.ssm.pojo"</span></span><br><span class="line">                            <span class="attribute">targetProject</span>=<span class="value">"src\main\java"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"enableSubPackages"</span> <span class="attribute">value</span>=<span class="value">"false"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 从数据库返回的值被清理前后的空格 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"trimStrings"</span> <span class="attribute">value</span>=<span class="value">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">javaModelGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- targetProject:mapper映射文件生成的位置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">sqlMapGenerator</span> <span class="attribute">targetPackage</span>=<span class="value">"com.lulee007.ssm.mapper"</span></span><br><span class="line">                         <span class="attribute">targetProject</span>=<span class="value">"src\main\resources"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"enableSubPackages"</span> <span class="attribute">value</span>=<span class="value">"false"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">sqlMapGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- targetPackage：mapper接口生成的位置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">javaClientGenerator</span> <span class="attribute">type</span>=<span class="value">"XMLMAPPER"</span></span><br><span class="line">                             <span class="attribute">targetPackage</span>=<span class="value">"com.lulee007.ssm.mapper"</span></span><br><span class="line">                             <span class="attribute">targetProject</span>=<span class="value">"src\main\java"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"enableSubPackages"</span> <span class="attribute">value</span>=<span class="value">"false"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">javaClientGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 指定数据库表 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">table</span> <span class="attribute">tableName</span>=<span class="value">"user"</span>&gt;</span><span class="tag">&lt;/<span class="title">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 有些表的字段需要指定java类型</span><br><span class="line">         &lt;table schema="" tableName=""&gt;</span><br><span class="line">            &lt;columnOverride column="" javaType="" /&gt;</span><br><span class="line">        &lt;/table&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>运行<code>mybatis-generator-maven</code>插件<br>在 Intellij 右边侧边栏选择<code>Maven Projects</code>,选择<code>Webapp</code>下的<code>Plugins</code>-&gt;<code>mybatis-generator</code><br>展开后，双击即可运行此插件。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160119-7%402x.png" alt="run mybatis-generator"><br>最后输出结果：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Scanning</span> <span class="tag">for</span> <span class="tag">projects</span>...</span><br><span class="line"><span class="attr_selector">[INFO]</span>                                                                         </span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Building</span> <span class="tag">ssm_demo</span> <span class="tag">Maven</span> <span class="tag">Webapp</span> <span class="tag">1</span><span class="class">.0-SNAPSHOT</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr_selector">[INFO]</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">---</span> <span class="tag">mybatis-generator-maven-plugin</span><span class="pseudo">:1</span><span class="class">.3</span><span class="class">.2</span><span class="pseudo">:generate</span> (default-cli) @ <span class="tag">ssm_demo</span> <span class="tag">---</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Connecting</span> <span class="tag">to</span> <span class="tag">the</span> <span class="tag">Database</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Introspecting</span> <span class="tag">table</span> <span class="tag">user</span></span><br><span class="line"><span class="tag">log4j</span><span class="pseudo">:WARN</span> <span class="tag">No</span> <span class="tag">appenders</span> <span class="tag">could</span> <span class="tag">be</span> <span class="tag">found</span> <span class="tag">for</span> <span class="tag">logger</span> (org.mybatis.generator.internal.db.DatabaseIntrospector).</span><br><span class="line"><span class="tag">log4j</span><span class="pseudo">:WARN</span> <span class="tag">Please</span> <span class="tag">initialize</span> <span class="tag">the</span> <span class="tag">log4j</span> <span class="tag">system</span> <span class="tag">properly</span>.</span><br><span class="line"><span class="tag">log4j</span><span class="pseudo">:WARN</span> <span class="tag">See</span> <span class="tag">http</span>:<span class="comment">//logging.apache.org/log4j/1.2/faq.html#noconfig for more info.</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Generating</span> <span class="tag">Example</span> <span class="tag">class</span> <span class="tag">for</span> <span class="tag">table</span> <span class="tag">user</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Generating</span> <span class="tag">Record</span> <span class="tag">class</span> <span class="tag">for</span> <span class="tag">table</span> <span class="tag">user</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Generating</span> <span class="tag">Mapper</span> <span class="tag">Interface</span> <span class="tag">for</span> <span class="tag">table</span> <span class="tag">user</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Generating</span> <span class="tag">SQL</span> <span class="tag">Map</span> <span class="tag">for</span> <span class="tag">table</span> <span class="tag">user</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Saving</span> <span class="tag">file</span> <span class="tag">UserMapper</span><span class="class">.xml</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Saving</span> <span class="tag">file</span> <span class="tag">UserExample</span><span class="class">.java</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Saving</span> <span class="tag">file</span> <span class="tag">User</span><span class="class">.java</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Saving</span> <span class="tag">file</span> <span class="tag">UserMapper</span><span class="class">.java</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">BUILD</span> <span class="tag">SUCCESS</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Total</span> <span class="tag">time</span>: <span class="tag">1</span><span class="class">.402s</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Finished</span> <span class="tag">at</span>: <span class="tag">Tue</span> <span class="tag">Jan</span> <span class="tag">19</span> <span class="tag">21</span><span class="pseudo">:56</span><span class="pseudo">:51</span> <span class="tag">CST</span> <span class="tag">2016</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">Final</span> <span class="tag">Memory</span>: <span class="tag">5M</span>/<span class="tag">123M</span></span><br><span class="line"><span class="attr_selector">[INFO]</span> <span class="tag">------------------------------------------------------------------------</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>build success 后应该会自动生成mapper接口文件、xml文件、pojo文件。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160120-0%402x.png" alt="generated file"></p>
<h3 id="u914D_u7F6EStruts2+Spring+Mybatis3"><a href="#u914D_u7F6EStruts2+Spring+Mybatis3" class="headerlink" title="配置Struts2+Spring+Mybatis3"></a>配置Struts2+Spring+Mybatis3</h3><p>在<code>pom.xml</code>里<code>dependencies</code>节点中添加依赖：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="title">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 与Struts2集成必须使用 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Struts2 依赖 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Struts2的核心包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.struts<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>struts2-core<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>$&#123;struts2.version&#125;<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Struts2和Spring整合插件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.struts<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>struts2-spring-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>$&#123;struts2.version&#125;<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Struts2 转json插件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.struts<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>struts2-json-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>$&#123;struts2.version&#125;<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- struts2-config-browser-plugin used in dev mode --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.struts<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>struts2-config-browser-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>$&#123;struts2.version&#125;<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- mybatis核心包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>$&#123;mybatis.version&#125;<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- mybatis/spring包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.2.1<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 日志文件管理包 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- log start --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>$&#123;log4j.version&#125;<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>$&#123;slf4j.version&#125;<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- log end --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--c3p0数据库--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>0.9.1.2<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="u914D_u7F6ELog4j"><a href="#u914D_u7F6ELog4j" class="headerlink" title="配置Log4j"></a>配置Log4j</h3><ol>
<li><p>在<code>main/resources</code>目录下新建<code>log4j.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="doctype">&lt;!DOCTYPE log4j:configuration SYSTEM "log4j.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">log4j:configuration</span> <span class="attribute">threshold</span>=<span class="value">"trace"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">appender</span> <span class="attribute">name</span>=<span class="value">"stdout-appender"</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.ConsoleAppender"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">layout</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.PatternLayout"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"ConversionPattern"</span> <span class="attribute">value</span>=<span class="value">"%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; %5p %c&#123;1&#125;: %m%n"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">appender</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">appender</span> <span class="attribute">name</span>=<span class="value">"sql-appender"</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.FileAppender"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"File"</span> <span class="attribute">value</span>=<span class="value">"db_sql.log"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"Append"</span> <span class="attribute">value</span>=<span class="value">"true"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">layout</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.PatternLayout"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"ConversionPattern"</span></span><br><span class="line">				<span class="attribute">value</span>=<span class="value">"-----&amp;gt; %d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; &amp;lt;%t&amp;gt; %m%n%n"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">appender</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">appender</span> <span class="attribute">name</span>=<span class="value">"sql-timing-appender"</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.FileAppender"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"File"</span> <span class="attribute">value</span>=<span class="value">"db_sqltiming.log"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"Append"</span> <span class="attribute">value</span>=<span class="value">"true"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">layout</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.PatternLayout"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"ConversionPattern"</span> <span class="attribute">value</span>=<span class="value">"-----&amp;gt; %d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; %m%n%n"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">appender</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">appender</span> <span class="attribute">name</span>=<span class="value">"jdbc-appender"</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.FileAppender"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"File"</span> <span class="attribute">value</span>=<span class="value">"db_jdbc.log"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"Append"</span> <span class="attribute">value</span>=<span class="value">"true"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">layout</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.PatternLayout"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"ConversionPattern"</span> <span class="attribute">value</span>=<span class="value">"%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; %m%n"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">appender</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">appender</span> <span class="attribute">name</span>=<span class="value">"jdbc-connection"</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.FileAppender"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"File"</span> <span class="attribute">value</span>=<span class="value">"db_connection.log"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"Append"</span> <span class="attribute">value</span>=<span class="value">"true"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">layout</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.PatternLayout"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"ConversionPattern"</span> <span class="attribute">value</span>=<span class="value">"%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; %m%n"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="title">appender</span> <span class="attribute">name</span>=<span class="value">"web-file"</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.RollingFileAppender"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"File"</span> <span class="attribute">value</span>=<span class="value">"web.log"</span> /&gt;</span><span class="comment">&lt;!-- 设置日志输出文件名 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 设置是否在重新启动服务时，在原有日志的基础添加新日志 --&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"Append"</span> <span class="attribute">value</span>=<span class="value">"true"</span> /&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"MaxBackupIndex"</span> <span class="attribute">value</span>=<span class="value">"30"</span> /&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;<span class="title">layout</span> <span class="attribute">class</span>=<span class="value">"org.apache.log4j.PatternLayout"</span>&gt;</span>       </span><br><span class="line">            <span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"ConversionPattern"</span> <span class="attribute">value</span>=<span class="value">"%-d&#123;yyyy-MM-dd HH:mm:ss&#125;- [ %p ] %l %m%n"</span> /&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;/<span class="title">layout</span>&gt;</span>       </span><br><span class="line">    <span class="tag">&lt;/<span class="title">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	 <span class="comment">&lt;!-- spring --&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"org.springframework"</span> <span class="attribute">additivity</span>=<span class="value">"true"</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"debug"</span> /&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	 <span class="comment">&lt;!-- xwork --&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"com.opensymphony"</span> <span class="attribute">additivity</span>=<span class="value">"true"</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"debug"</span> /&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	 <span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"org.apache.struts2"</span> <span class="attribute">additivity</span>=<span class="value">"true"</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"debug"</span> /&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	 <span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"freemarker.log.Log4JLoggerFactory"</span> <span class="attribute">additivity</span>=<span class="value">"true"</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"debug"</span> /&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="title">logger</span>&gt;</span>	 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- The Following 5 logs can be turned on and off while the server is running</span><br><span class="line">		LIVE in order to trace the SQL and/or all JDBC coming out of the application.</span><br><span class="line">		To turn a log on, set the level value to INFO or DEBUG (to see class name</span><br><span class="line">		and line number information in the log) The DEBUG setting is much more inefficient</span><br><span class="line">		but the output is much more useful. To turn off JDBC logging completely,</span><br><span class="line">		you must set all 5 logs to a level higher than ERROR (FATAL is suggested.) --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- log SQL (pre-execution) plus exceptions caused by SQL --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"jdbc.sqlonly"</span> <span class="attribute">additivity</span>=<span class="value">"false"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"error"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"stdout-appender"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- log SQL with timing information, post execution --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"jdbc.sqltiming"</span> <span class="attribute">additivity</span>=<span class="value">"true"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"debug"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"sql-timing-appender"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- only use the two logs below to trace ALL JDBC information, <span class="doctag">NOTE:</span> This</span><br><span class="line">		can be very voluminous! --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- log all jdbc calls except ResultSet calls --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"jdbc.audit"</span> <span class="attribute">additivity</span>=<span class="value">"false"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"error"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"stdout-appender"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- log the jdbc ResultSet calls --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"jdbc.resultset"</span> <span class="attribute">additivity</span>=<span class="value">"false"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"error"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"stdout-appender"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- log connection open/close events and dump of all open connection numbers --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"jdbc.connection"</span> <span class="attribute">additivity</span>=<span class="value">"false"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"error"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"stdout-appender"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- this log is for internal debugging of log4jdbc, itself --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- debug logging for log4jdbc itself --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"log4jdbc.debug"</span> <span class="attribute">additivity</span>=<span class="value">"false"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"error"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"stdout-appender"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- by default, log everything to the console with a level of WARN or higher --&gt;</span></span><br><span class="line">	 <span class="comment">&lt;!-- 指定logger的设置，additivity指示是否遵循缺省的继承机制--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"org.apache.activemq.transport.AbstractInactivityMonitor"</span> <span class="attribute">additivity</span>=<span class="value">"false"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span> =<span class="value">"error"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"stdout-appender"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"com.mchange.v2.resourcepool.BasicResourcePool"</span> <span class="attribute">additivity</span>=<span class="value">"false"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"error"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"stdout-appender"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool"</span> <span class="attribute">additivity</span>=<span class="value">"false"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"error"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"stdout-appender"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">logger</span> <span class="attribute">name</span>=<span class="value">"com.mchange.v2.c3p0.impl.NewPooledConnection"</span> <span class="attribute">additivity</span>=<span class="value">"false"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"error"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"stdout-appender"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="title">root</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">level</span> <span class="attribute">value</span>=<span class="value">"debug"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"stdout-appender"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">appender-ref</span> <span class="attribute">ref</span>=<span class="value">"web-file"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">log4j:configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>并拷贝<code>log4j.dtd</code>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span><br><span class="line">         Licensed to the Apache Software Foundation (ASF) under one or more</span><br><span class="line">         contributor license agreements.  See the NOTICE file distributed with</span><br><span class="line">         this work for additional information regarding copyright ownership.</span><br><span class="line">         The ASF licenses this file to You under the Apache License, Version 2.0</span><br><span class="line">         (the "License"); you may not use this file except in compliance with</span><br><span class="line">         the License.  You may obtain a copy of the License at</span><br><span class="line"></span><br><span class="line">              http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="line"></span><br><span class="line">         Unless required by applicable law or agreed to in writing, software</span><br><span class="line">         distributed under the License is distributed on an "AS IS" BASIS,</span><br><span class="line">         WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line">         See the License for the specific language governing permissions and</span><br><span class="line">         limitations under the License.</span><br><span class="line">        --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Authors: Chris Taylor, Ceki Gulcu. --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Version: 1.2 --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- A configuration element consists of optional renderer</span><br><span class="line">        elements,appender elements, categories and an optional root</span><br><span class="line">        element. --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">log4j:configuration</span> (<span class="attribute">renderer</span>*, <span class="attribute">appender</span>*,<span class="attribute">plugin</span>*, (<span class="attribute">category</span>|<span class="attribute">logger</span>)*,<span class="attribute">root</span>?,</span><br><span class="line">                (<span class="attribute">categoryFactory</span>|<span class="attribute">loggerFactory</span>)?)&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- The "threshold" attribute takes a level value below which --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- all logging statements are disabled. --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Setting the "debug" enable the printing of internal log4j logging   --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- statements.                                                         --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- By default, debug attribute is "null", meaning that we not do touch --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- internal log4j logging settings. The "null" value for the threshold --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- attribute can be misleading. The threshold field of a repository	 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- cannot be set to null. The "null" value for the threshold attribute --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- simply means don't touch the threshold field, the threshold field   --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- keeps its old value.                                                --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">log4j:configuration</span></span><br><span class="line">                <span class="attribute">xmlns:log4j</span>              <span class="attribute">CDATA</span> #<span class="attribute">FIXED</span> "<span class="attribute">http:</span>//<span class="attribute">jakarta.apache.org</span>/<span class="attribute">log4j</span>/"</span><br><span class="line">                <span class="attribute">threshold</span>                (<span class="attribute">all</span>|<span class="attribute">trace</span>|<span class="attribute">debug</span>|<span class="attribute">info</span>|<span class="attribute">warn</span>|<span class="attribute">error</span>|<span class="attribute">fatal</span>|<span class="attribute">off</span>|<span class="attribute">null</span>) "<span class="attribute">null</span>"</span><br><span class="line">                <span class="attribute">debug</span>                    (<span class="attribute">true</span>|<span class="attribute">false</span>|<span class="attribute">null</span>)  "<span class="attribute">null</span>"</span><br><span class="line">                <span class="attribute">reset</span>                    (<span class="attribute">true</span>|<span class="attribute">false</span>) "<span class="attribute">false</span>"</span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- renderer elements allow the user to customize the conversion of  --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- message objects to String.                                       --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">renderer</span> <span class="attribute">EMPTY</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">renderer</span></span><br><span class="line">                <span class="attribute">renderedClass</span>  <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">renderingClass</span> <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Appenders must have a name and a class. --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Appenders may contain an error handler, a layout, optional parameters --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- and filters. They may also reference (or include) other appenders. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">appender</span> (<span class="attribute">errorHandler</span>?, <span class="attribute">param</span>*,</span><br><span class="line">                <span class="attribute">rollingPolicy</span>?, <span class="attribute">triggeringPolicy</span>?, <span class="attribute">connectionSource</span>?,</span><br><span class="line">                <span class="attribute">layout</span>?, <span class="attribute">filter</span>*, <span class="attribute">appender-ref</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">appender</span></span><br><span class="line">                <span class="attribute">name</span>        <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">class</span>    <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">layout</span> (<span class="attribute">param</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">layout</span></span><br><span class="line">                <span class="attribute">class</span>        <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">filter</span> (<span class="attribute">param</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">filter</span></span><br><span class="line">                <span class="attribute">class</span>        <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- ErrorHandlers can be of any class. They can admit any number of --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- parameters. --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">errorHandler</span> (<span class="attribute">param</span>*, <span class="attribute">root-ref</span>?, <span class="attribute">logger-ref</span>*,  <span class="attribute">appender-ref</span>?)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">errorHandler</span></span><br><span class="line">                <span class="attribute">class</span>        <span class="attribute">CDATA</span>   #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">root-ref</span> <span class="attribute">EMPTY</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">logger-ref</span> <span class="attribute">EMPTY</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">logger-ref</span></span><br><span class="line">                <span class="attribute">ref</span> <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">param</span> <span class="attribute">EMPTY</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">param</span></span><br><span class="line">                <span class="attribute">name</span>        <span class="attribute">CDATA</span>   #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">value</span>        <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- The priority class is org.apache.log4j.Level by default --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">priority</span> (<span class="attribute">param</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">priority</span></span><br><span class="line">                <span class="attribute">class</span>   <span class="attribute">CDATA</span>    #<span class="attribute">IMPLIED</span></span><br><span class="line">                <span class="attribute">value</span>      <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- The level class is org.apache.log4j.Level by default --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">level</span> (<span class="attribute">param</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">level</span></span><br><span class="line">                <span class="attribute">class</span>   <span class="attribute">CDATA</span>    #<span class="attribute">IMPLIED</span></span><br><span class="line">                <span class="attribute">value</span>      <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- If no level element is specified, then the configurator MUST not --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- touch the level of the named category. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">category</span> (<span class="attribute">param</span>*,(<span class="attribute">priority</span>|<span class="attribute">level</span>)?,<span class="attribute">appender-ref</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">category</span></span><br><span class="line">                <span class="attribute">class</span>         <span class="attribute">CDATA</span>   #<span class="attribute">IMPLIED</span></span><br><span class="line">                <span class="attribute">name</span>        <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">additivity</span>    (<span class="attribute">true</span>|<span class="attribute">false</span>) "<span class="attribute">true</span>"</span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- If no level element is specified, then the configurator MUST not --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- touch the level of the named logger. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">logger</span> (<span class="attribute">level</span>?,<span class="attribute">appender-ref</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">logger</span></span><br><span class="line">                <span class="attribute">name</span>        <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">additivity</span>    (<span class="attribute">true</span>|<span class="attribute">false</span>) "<span class="attribute">true</span>"</span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">categoryFactory</span> (<span class="attribute">param</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">categoryFactory</span></span><br><span class="line">                <span class="attribute">class</span>        <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">loggerFactory</span> (<span class="attribute">param</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">loggerFactory</span></span><br><span class="line">                <span class="attribute">class</span>        <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">appender-ref</span> <span class="attribute">EMPTY</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">appender-ref</span></span><br><span class="line">                <span class="attribute">ref</span> <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- plugins must have a name and class and can have optional parameters --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">plugin</span> (<span class="attribute">param</span>*, <span class="attribute">connectionSource</span>?)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">plugin</span></span><br><span class="line">                <span class="attribute">name</span>        <span class="attribute">CDATA</span>       #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">class</span>    <span class="attribute">CDATA</span>  #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">connectionSource</span> (<span class="attribute">dataSource</span>?, <span class="attribute">param</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">connectionSource</span></span><br><span class="line">                <span class="attribute">class</span>        <span class="attribute">CDATA</span>  #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">dataSource</span> (<span class="attribute">param</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">dataSource</span></span><br><span class="line">                <span class="attribute">class</span>        <span class="attribute">CDATA</span>  #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">triggeringPolicy</span> ((<span class="attribute">param</span>|<span class="attribute">filter</span>)*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">triggeringPolicy</span></span><br><span class="line">                <span class="attribute">name</span>        <span class="attribute">CDATA</span>  #<span class="attribute">IMPLIED</span></span><br><span class="line">                <span class="attribute">class</span>    <span class="attribute">CDATA</span>  #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">rollingPolicy</span> (<span class="attribute">param</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">rollingPolicy</span></span><br><span class="line">                <span class="attribute">name</span>        <span class="attribute">CDATA</span>  #<span class="attribute">IMPLIED</span></span><br><span class="line">                <span class="attribute">class</span>    <span class="attribute">CDATA</span>  #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- If no priority element is specified, then the configurator MUST not --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- touch the priority of root. --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- The root category always exists and cannot be subclassed. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">root</span> (<span class="attribute">param</span>*, (<span class="attribute">priority</span>|<span class="attribute">level</span>)?, <span class="attribute">appender-ref</span>*)&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- ==================================================================== --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--                       A logging event                                --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ==================================================================== --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">log4j:eventSet</span> (<span class="attribute">log4j:event</span>*)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">log4j:eventSet</span></span><br><span class="line">                <span class="attribute">xmlns:log4j</span>             <span class="attribute">CDATA</span> #<span class="attribute">FIXED</span> "<span class="attribute">http:</span>//<span class="attribute">jakarta.apache.org</span>/<span class="attribute">log4j</span>/"</span><br><span class="line">                <span class="attribute">version</span>                (<span class="attribute">1.1</span>|<span class="attribute">1.2</span>) "<span class="attribute">1.2</span>"</span><br><span class="line">                <span class="attribute">includesLocationInfo</span>   (<span class="attribute">true</span>|<span class="attribute">false</span>) "<span class="attribute">true</span>"</span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">log4j:event</span> (<span class="attribute">log4j:message</span>, <span class="attribute">log4j:NDC</span>?, <span class="attribute">log4j:throwable</span>?,</span><br><span class="line">                <span class="attribute">log4j:locationInfo</span>?, <span class="attribute">log4j:properties</span>?) &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- The timestamp format is application dependent. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">log4j:event</span></span><br><span class="line">                <span class="attribute">logger</span>     <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">level</span>      <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">thread</span>     <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">timestamp</span>  <span class="attribute">CDATA</span> #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">time</span>       <span class="attribute">CDATA</span> #<span class="attribute">IMPLIED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">log4j:message</span> (#<span class="attribute">PCDATA</span>)&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">log4j:NDC</span> (#<span class="attribute">PCDATA</span>)&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">log4j:throwable</span> (#<span class="attribute">PCDATA</span>)&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">log4j:locationInfo</span> <span class="attribute">EMPTY</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">log4j:locationInfo</span></span><br><span class="line">                <span class="attribute">class</span>  <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">method</span> <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">file</span>   <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">line</span>   <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">log4j:properties</span> (<span class="attribute">log4j:data</span>*)&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ELEMENT</span> <span class="attribute">log4j:data</span> <span class="attribute">EMPTY</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">!ATTLIST</span> <span class="attribute">log4j:data</span></span><br><span class="line">                <span class="attribute">name</span>   <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                <span class="attribute">value</span>  <span class="attribute">CDATA</span>    #<span class="attribute">REQUIRED</span></span><br><span class="line">                &gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="u914D_u7F6E_ApplicationContext"><a href="#u914D_u7F6E_ApplicationContext" class="headerlink" title="配置 ApplicationContext"></a>配置 ApplicationContext</h3><p>配置 Spring IOC 注入和事件控制，在<code>main/resources/config/spring</code> 中分别创建<code>applicationContext-dao.xml</code>、<code>applicationContext-service.xml</code>、<code>applicationContext-transaction.xml</code>文件。</p>
<ul>
<li><p><code>applicationContext-dao.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">beans</span> <span class="attribute">xmlns</span>=<span class="value">"http://www.springframework.org/schema/beans"</span> <span class="attribute">xmlns:xsi</span>=<span class="value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attribute">xmlns:context</span>=<span class="value">"http://www.springframework.org/schema/context"</span> <span class="attribute">xsi:schemaLocation</span>=<span class="value">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--获取数据库配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">context:property-placeholder</span> <span class="attribute">location</span>=<span class="value">"classpath:mysql_db.properties"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置数据源c3p0--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">bean</span> <span class="attribute">id</span>=<span class="value">"dataSource"</span> <span class="attribute">class</span>=<span class="value">"com.mchange.v2.c3p0.ComboPooledDataSource"</span> <span class="attribute">destroy-method</span>=<span class="value">"close"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"driverClass"</span> <span class="attribute">value</span>=<span class="value">"$&#123;jdbc.driver&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"jdbcUrl"</span> <span class="attribute">value</span>=<span class="value">"$&#123;jdbc.url&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"user"</span> <span class="attribute">value</span>=<span class="value">"$&#123;jdbc.username&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"password"</span> <span class="attribute">value</span>=<span class="value">"$&#123;jdbc.password&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"maxPoolSize"</span> <span class="attribute">value</span>=<span class="value">"50"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"minPoolSize"</span> <span class="attribute">value</span>=<span class="value">"2"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"maxIdleTime"</span> <span class="attribute">value</span>=<span class="value">"60"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--sqlsessionFactory bean--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">bean</span> <span class="attribute">id</span>=<span class="value">"sqlSession"</span> <span class="attribute">class</span>=<span class="value">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"configLocation"</span> <span class="attribute">value</span>=<span class="value">"classpath:config/mybatis/SqlMapConfig.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"dataSource"</span> <span class="attribute">ref</span>=<span class="value">"dataSource"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--自动扫描mapper接口，并注入sqlsession--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">bean</span> <span class="attribute">class</span>=<span class="value">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"basePackage"</span> <span class="attribute">value</span>=<span class="value">"com.lulee007.ssm.mapper"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"sqlSessionFactoryBeanName"</span> <span class="attribute">value</span>=<span class="value">"sqlSession"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>applicationContext-service.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">beans</span> <span class="attribute">xmlns</span>=<span class="value">"http://www.springframework.org/schema/beans"</span></span><br><span class="line">       <span class="attribute">xmlns:xsi</span>=<span class="value">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line">       <span class="attribute">xmlns:context</span>=<span class="value">"http://www.springframework.org/schema/context"</span></span><br><span class="line">       <span class="attribute">xsi:schemaLocation</span>=<span class="value">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!--扫描service--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="title">context:component-scan</span> <span class="attribute">base-package</span>=<span class="value">"com.lulee007.ssm.service"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>applicationContext-transaction.xml</code></p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;beans xmlns=<span class="string">"http://www.springframework.org/schema/beans"</span></span><br><span class="line">       xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> xmlns:tx=<span class="string">"http://www.springframework.org/schema/tx"</span></span><br><span class="line">       xmlns:aop=<span class="string">"http://www.springframework.org/schema/aop"</span></span><br><span class="line">       xsi:schemaLocation=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       &lt;bean id=<span class="string">"dataSourceTransactionManager"</span> class=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span><br><span class="line">              &lt;property name=<span class="string">"dataSource"</span> <span class="keyword">ref</span>=<span class="string">"dataSource"</span>/&gt;</span><br><span class="line">       &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">       &lt;tx:advice id=<span class="string">"txAdvice"</span> transaction-manager=<span class="string">"dataSourceTransactionManager"</span>&gt;</span><br><span class="line">              &lt;tx:attributes&gt;</span><br><span class="line">                     &lt;tx:<span class="keyword">method</span> name=<span class="string">"find*"</span> propagation=<span class="string">"REQUIRED"</span>/&gt;</span><br><span class="line">                     &lt;tx:<span class="keyword">method</span> name=<span class="string">"update*"</span> propagation=<span class="string">"REQUIRED"</span>/&gt;</span><br><span class="line">                     &lt;tx:<span class="keyword">method</span> name=<span class="string">"delete*"</span> propagation=<span class="string">"REQUIRED"</span>/&gt;</span><br><span class="line">                     &lt;tx:<span class="keyword">method</span> name=<span class="string">"add*"</span> propagation=<span class="string">"REQUIRED"</span>/&gt;</span><br><span class="line">              &lt;/tx:attributes&gt;</span><br><span class="line">       &lt;/tx:advice&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="u914D_u7F6EStruts2"><a href="#u914D_u7F6EStruts2" class="headerlink" title="配置Struts2"></a>配置<code>Struts2</code></h3><p>在<code>src/main/resources/config/struts2</code>目录下添加<code>struts-core.xml</code>文件:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="doctype">&lt;!DOCTYPE struts PUBLIC</span><br><span class="line">        "-//Apache Software Foundation//DTD Struts Configuration 2.1.7//EN"</span><br><span class="line">        "http://struts.apache.org/dtds/struts-2.1.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">struts</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 加载STRUTS默认配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">include</span> <span class="attribute">file</span>=<span class="value">"struts-default.xml"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">include</span> <span class="attribute">file</span>=<span class="value">"struts-plugin.xml"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 声明STRUTS常量配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">constant</span> <span class="attribute">name</span>=<span class="value">"struts.enable.DynamicMethodInvocation"</span> <span class="attribute">value</span>=<span class="value">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">constant</span> <span class="attribute">name</span>=<span class="value">"struts.ognl.allowStaticMethodAccess"</span> <span class="attribute">value</span>=<span class="value">"true"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- struts.devMode used in dev mode --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">constant</span> <span class="attribute">name</span>=<span class="value">"struts.devMode"</span> <span class="attribute">value</span>=<span class="value">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">constant</span> <span class="attribute">name</span>=<span class="value">"struts.i18n.encoding"</span> <span class="attribute">value</span>=<span class="value">"UTF-8"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">constant</span> <span class="attribute">name</span>=<span class="value">"struts.objectFactory"</span></span><br><span class="line">              <span class="attribute">value</span>=<span class="value">"org.apache.struts2.spring.StrutsSpringObjectFactory"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- &lt;constant name="struts.multipart.saveDir" value="/temp"/&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">constant</span> <span class="attribute">name</span>=<span class="value">"struts.ui.theme"</span> <span class="attribute">value</span>=<span class="value">"simple"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- &lt;constant name="struts.action.extension" value=","/&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;constant name="struts.multipart.saveDir" value="d:uploadtemp"/&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 改变struts2默认为2M的上传文件大小限制 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">constant</span> <span class="attribute">name</span>=<span class="value">"struts.multipart.maxSize"</span> <span class="attribute">value</span>=<span class="value">"1024000000"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定不经过struts2框架处理的URL规则--&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- &lt;constant name="struts.action.excludePattern" value="/downloadFile,/httpService,/dwr/.*,/dwr/test/.*"/&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 加载JSON结果转换,加载自定义结果 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">package</span> <span class="attribute">name</span>=<span class="value">"my-struts"</span> <span class="attribute">extends</span>=<span class="value">"struts-default"</span> <span class="attribute">namespace</span>=<span class="value">"/"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">result-types</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">result-type</span> <span class="attribute">name</span>=<span class="value">"json"</span> <span class="attribute">class</span>=<span class="value">"org.apache.struts2.json.JSONResult"</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 这里指定将被Struts2序列化的属性，该属性在action中必须有对应的getter方法 --&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 指定是否序列化空的属性 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"defaultEncoding"</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="title">param</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"excludeNullProperties"</span>&gt;</span>false<span class="tag">&lt;/<span class="title">param</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 指定内容类型，默认为application/json，IE浏览器会提示下载 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"contentType"</span>&gt;</span>text/html<span class="tag">&lt;/<span class="title">param</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 是否启用压缩 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"enableGZIP"</span>&gt;</span>false<span class="tag">&lt;/<span class="title">param</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 是否忽略层级关系,即不关注父类中的对象 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"ignoreHierarchy"</span>&gt;</span>false<span class="tag">&lt;/<span class="title">param</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 排除的对象 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">param</span> <span class="attribute">name</span>=<span class="value">"excludeProperties"</span>&gt;</span></span><br><span class="line">                    request,session</span><br><span class="line">                <span class="tag">&lt;/<span class="title">param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">result-type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">result-types</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">interceptors</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">interceptor</span> <span class="attribute">name</span>=<span class="value">"json"</span> <span class="attribute">class</span>=<span class="value">"org.apache.struts2.json.JSONInterceptor"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">interceptor-stack</span> <span class="attribute">name</span>=<span class="value">"myStack"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">interceptor-ref</span> <span class="attribute">name</span>=<span class="value">"defaultStack"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">interceptor-stack</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">interceptors</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">default-interceptor-ref</span> <span class="attribute">name</span>=<span class="value">"myStack"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- comment added by lulee007 设置找不到action默认跳转的页面-&gt;首页 index --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">default-action-ref</span> <span class="attribute">name</span>=<span class="value">"index"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">global-results</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">result</span> <span class="attribute">name</span>=<span class="value">"json"</span> <span class="attribute">type</span>=<span class="value">"json"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">result</span> <span class="attribute">name</span>=<span class="value">"index"</span> <span class="attribute">type</span>=<span class="value">"redirect"</span>&gt;</span>/index<span class="tag">&lt;/<span class="title">result</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">result</span> <span class="attribute">name</span>=<span class="value">"exception"</span>&gt;</span>/views/common/error.jsp<span class="tag">&lt;/<span class="title">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">global-results</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="title">package</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 预留加载业务-Action配置   --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;include file="config/struts2/struts-user.xml"/&gt;--&gt;</span>      </span><br><span class="line"><span class="tag">&lt;/<span class="title">struts</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="u914D_u7F6Eweb-xml_u6587_u4EF6"><a href="#u914D_u7F6Eweb-xml_u6587_u4EF6" class="headerlink" title="配置web.xml文件"></a>配置<code>web.xml</code>文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">web-app</span> <span class="attribute">xmlns</span>=<span class="value">"http://xmlns.jcp.org/xml/ns/javaee"</span> <span class="attribute">xmlns:xsi</span>=<span class="value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attribute">xsi:schemaLocation</span>=<span class="value">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"</span> <span class="attribute">version</span>=<span class="value">"3.1"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 设置log4j --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">param-name</span>&gt;</span>log4jConfigLocation<span class="tag">&lt;/<span class="title">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">param-value</span>&gt;</span>classpath:config/log4j/log4j.xml<span class="tag">&lt;/<span class="title">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">context-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置spring 配置文件的位置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="title">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">param-value</span>&gt;</span>classpath*:config/spring/applicationContext-*.xml<span class="tag">&lt;/<span class="title">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">context-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置spring listener--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="title">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">listener-class</span>&gt;</span>org.springframework.web.util.Log4jConfigListener<span class="tag">&lt;/<span class="title">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">listener</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--解决POST乱码问题--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="title">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="title">filter-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="title">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="title">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="title">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="title">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Struts2的核心过滤器配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="title">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">filter-class</span>&gt;</span></span><br><span class="line">            org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</span><br><span class="line">        <span class="tag">&lt;/<span class="title">filter-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">param-name</span>&gt;</span>config<span class="tag">&lt;/<span class="title">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">param-value</span>&gt;</span>config/struts2/struts-core.xml<span class="tag">&lt;/<span class="title">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">init-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="title">filter</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Struts2过滤器拦截所有的.action请求 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="title">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="title">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="u914D_u7F6E_tomcat__u542F_u52A8"><a href="#u914D_u7F6E_tomcat__u542F_u52A8" class="headerlink" title="配置 tomcat 启动"></a>配置 tomcat 启动</h3><p>点击 Intellij 顶部工具栏的<code>Run/Debug Configurations...</code>，选择<code>Edit Configurations...</code><br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160121-0%402x.png" alt="edit configurations"><br>在弹出来的配置对话框中，点击左上角的<code>+</code>选择添加<code>Tomcat Server</code>-&gt;<code>Local</code>来添加一个本地的<code>Tomcat Server</code>，<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160121-1%402x.png" alt="add tomcat server"><br>然后配置 <code>tomcat server</code>:<br>填写顶部的<code>Name</code>，输入我们的工程名称<code>ssm_demo</code>，然后会在底部有个小灯泡提示，<code>No artifacts for deployment</code>，我们点击<code>Fix</code><br>会有两个选择，我们选择第二个<code>ssm_demo war:exploded</code>，然后在<code>Deployment</code>标签页，填写<code>Application context</code>，输入<code>/ssm_demo</code>，这样当启动tomcat后，打开浏览器输入『localhost://8080/ssm_demo』就可以看到我们的主页了。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_addtomcat.gif" alt="setting tomcat"><br><strong>注意：</strong> 如果在启动过程中提示端口号被占，可以通过修改这个<code>config</code>的<code>Http port</code>：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160122-0%402x.png" alt="set http port"></p>
<h2 id="u6D4B_u8BD5_u542F_u52A8"><a href="#u6D4B_u8BD5_u542F_u52A8" class="headerlink" title="测试启动"></a>测试启动</h2><p>目前配置好了基本的项目，现在来测试一下：<br>点击 Intellij 顶部工具栏的<code>Run/Debug Configurations...</code>，这个时候应该有默认我们配置好的<code>ssm_demo</code>可以启动了。<br>点击 旁边的 <code>Run</code>（三角形），或者按快捷键<code>Command</code>+<code>R</code>来运行。<br>这时，Intellij 应该会自动弹出默认浏览器并打开主页<code>http://localhost:8082/ssm_demo/</code>，手动输入此地址也可以看到以下内容:<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160122-1%402x.png" alt="home page"></p>
<h3 id="u7F16_u5199UserService"><a href="#u7F16_u5199UserService" class="headerlink" title="编写UserService"></a>编写UserService</h3><p>编写Service来去数据库的用户信息：<br>新建<code>UserService.java</code>接口文件到<code>src/main/java/com/lulee007/ssm/service/</code>目录下，输入下面的代码：<br><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">package com.lulee007.ssm.service;</span><br><span class="line"></span><br><span class="line">import com.lulee007.ssm.pojo.User;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line"> <span class="keyword">*</span> Created by lulee007 on 16/1/19.</span><br><span class="line"> <span class="keyword">*</span>/</span><br><span class="line">public interface UserService &#123;</span><br><span class="line">    /<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">     <span class="keyword">*</span> 查找所有用户</span><br><span class="line">     <span class="keyword">*</span> <span class="comment">@return</span></span><br><span class="line">     <span class="keyword">*</span> <span class="comment">@throws Exception</span></span><br><span class="line">     <span class="keyword">*</span>/</span><br><span class="line">    List<span class="variable">&lt;User&gt;</span> findUser()throws Exception;</span><br><span class="line"></span><br><span class="line">    Boolean saveUser(User user) throws  Exception;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后新建<code>userServiceImpl.java</code>接口文件到<code>src/main/java/com/lulee007/ssm/service/</code>目录下，输入下面的代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lulee007.ssm.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.lulee007.ssm.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.lulee007.ssm.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * Created by lulee007 on 16/1/19.</span><br><span class="line"> */</span></span><br><span class="line"> <span class="comment">// 注解为spring service</span></span><br><span class="line"><span class="annotation">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//User接口</span></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findUser</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//调用mapper类中的selectByExample方法，如果传入类型为null，则表示无条件查找</span></span><br><span class="line">        List&lt;User&gt; users = userMapper.selectByExample(<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">saveUser</span><span class="params">(User user)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.insertSelective(user)==<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="u7F16_u5199UserAction"><a href="#u7F16_u5199UserAction" class="headerlink" title="编写UserAction"></a>编写UserAction</h3><p>接下来测试一下 Struts2 ，我们用之前mybatis 帮我们生成好的 pojo,dao,mapper 来写一个展示user 信息的表格：</p>
<ul>
<li><p>新建<code>UserAction.java</code>到<code>src/main/java/com/lulee007/ssm/action/</code>目录下，输入下面的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lulee007.ssm.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.lulee007.ssm.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.lulee007.ssm.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * Created by lulee007 on 16/1/21.</span><br><span class="line"> */</span></span><br><span class="line"><span class="comment">//将这个UserAction 注解为Controller</span></span><br><span class="line"><span class="annotation">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAction</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自动注解UserService</span></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> List&lt;User&gt; users;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//action 默认执行的入口</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//取出所有user</span></span><br><span class="line">            users=userService.findUser();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//设置标题</span></span><br><span class="line">        title=<span class="string">"My User Page"</span>+<span class="keyword">new</span> Date();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span><br><span class="line">     * 以下是 getter setter 在jsp里要调用我们的 title 和 users 就必须写setter getter方法,不然</span><br><span class="line">     * 没法取到或设置其值.</span><br><span class="line">     * ****/</span></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTitle</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.title = title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsers</span><span class="params">(List&lt;User&gt; users)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.users = users;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建<code>action-user.xml</code><br>创建<code>action-user.xml</code>文件到<code>src/main/resources/config/struts2/</code>目录下，输入下面的内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="doctype">&lt;!DOCTYPE struts PUBLIC</span><br><span class="line">        "-//Apache Software Foundation//DTD Struts Configuration 2.1.7//EN"</span><br><span class="line">        "http://struts.apache.org/dtds/struts-2.1.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">struts</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">package</span> <span class="attribute">name</span>=<span class="value">"home"</span> <span class="attribute">extends</span>=<span class="value">"my-struts"</span> <span class="attribute">namespace</span>=<span class="value">"/user"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- User 列表页 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">action</span> <span class="attribute">name</span>=<span class="value">"index"</span> <span class="attribute">class</span>=<span class="value">"com.lulee007.ssm.action.UserAction"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--action 返回值为success时,则返回页面user.jsp,并解析为html展示到网页--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">result</span> <span class="attribute">name</span>=<span class="value">"success"</span>&gt;</span>/WEB-INF/views/user.jsp<span class="tag">&lt;/<span class="title">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">action</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="title">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改之前我们创建的<code>src/main/resources/config/struts2/struts-core.xml</code>，<br>把最后面，取消注释，最终如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 加载业务-Action配置   --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="title">include</span> <span class="attribute">file</span>=<span class="value">"config/struts2/struts-user.xml"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加<code>user.jsp</code>文件到<code>src/main/webapp/WEB-INF/views/</code>目录下：</p>
<figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"></span><span class="vbscript">&lt;%--</span><br><span class="line">  Created by IntelliJ IDEA.</span><br><span class="line">  User: lulee007</span><br><span class="line">  <span class="built_in">Date</span>: <span class="number">16</span>/<span class="number">1</span>/<span class="number">21</span></span><br><span class="line">  <span class="built_in">Time</span>: <span class="number">21</span>:<span class="number">39</span></span><br><span class="line">  <span class="keyword">To</span> change this template use File | Settings | File Templates.</span><br><span class="line">--%&gt;</span><span class="xml"></span><br><span class="line"></span><span class="vbscript">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><span class="xml"></span><br><span class="line"></span><span class="vbscript">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span><span class="xml"></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>$&#123;title&#125;<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line"></span><span class="vbscript">&lt;%--显示我们的设置的标题--%&gt;</span><span class="xml"></span><br><span class="line"><span class="tag">&lt;<span class="title">h1</span>&gt;</span>$&#123;title&#125;<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line"></span><span class="vbscript">&lt;%--显示我们从数据库取出来的用户数据--%&gt;</span><span class="xml"></span><br><span class="line"><span class="tag">&lt;<span class="title">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">td</span>&gt;</span></span><br><span class="line">            Name</span><br><span class="line">        <span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">td</span>&gt;</span></span><br><span class="line">            Birthday</span><br><span class="line">        <span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">td</span>&gt;</span></span><br><span class="line">            Sex</span><br><span class="line">        <span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">td</span>&gt;</span></span><br><span class="line">            Address</span><br><span class="line">        <span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">tbody</span>&gt;</span></span><br><span class="line">    </span><span class="vbscript">&lt;%--struts2的遍历标签,循环取出用户的信息--%&gt;</span><span class="xml"></span><br><span class="line">    <span class="tag">&lt;<span class="title">s:iterator</span> <span class="attribute">value</span>=<span class="value">"users"</span> <span class="attribute">id</span>=<span class="value">"user"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">td</span>&gt;</span>$&#123;user.username&#125;<span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">td</span>&gt;</span>$&#123;user.birthday&#125;<span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">td</span>&gt;</span>$&#123;user.sex&#125;<span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">td</span>&gt;</span>$&#123;user.address&#125;<span class="tag">&lt;/<span class="title">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="title">s:iterator</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>重新运行 tomcat ，然后在地址栏里输入：<code>http://localhost:8082/ssm_demo/user/index</code><br>可以看到页面：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160122-2%402x.png" alt="user page"></p>
<h3 id="strtus_action_u63D2_u4EF6"><a href="#strtus_action_u63D2_u4EF6" class="headerlink" title="strtus action插件"></a>strtus action插件</h3><p>Config Browser插件是一个可以在运行时查看应用配置的简单工具. 在调试一些和配置相关的问题时, 非常有用.<br><strong>功能</strong> </p>
<blockquote>
<p>Browsable view of loaded configuration 浏览已加载的配置<br>Shows all accessible action URLs 查看所有可以访问的URL</p>
</blockquote>
<p>直接在浏览器输入<code>YOUR_HOST</code>+<code>config-browser/index.action</code>即可，如<code>http://localhost:8082/ssm_demo/config-browser/index.action</code><br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160122-3%402x.png" alt="confit-browser-1"><br>这个是我们的UserAction相关的信息：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160122-4%402x.png" alt="confit-browser-user-action"></p>
<h2 id="u6700_u540E"><a href="#u6700_u540E" class="headerlink" title="最后"></a>最后</h2><p>至此我们完成了所有配置，本文主要介绍了最基本的用法，如果需要其他功能在这个基础上进行扩展即可。<br>项目源码：<a href="https://github.com/lulee007/ssm_demo" target="_blank" rel="external">https://github.com/lulee007/ssm_demo</a> tag:basic-ssm</p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>在 Intellij 中配置 SSM Web 开发框架。</p>
<ul>
<li>Struts2 主要用它的视图统筹</li>
<li>Spring 整个框架的统筹</li>
<li>Mybatis3 持久层,MyBatis 是支持定制化SQL、存储过程以及高级映射的优秀的持久层框架</li>
</ul>
<p>参考：<a href="http://blog.csdn.net/u011403655/article/details/46843331">夕下奕林:Idea SpringMVC+Spring+MyBatis+Maven整合</a><br>]]>
    
    </summary>
    
      <category term="Mybatis3" scheme="http://lulee007.gitcafe.io/tagsCN/Mybatis3/"/>
    
      <category term="Spring" scheme="http://lulee007.gitcafe.io/tagsCN/Spring/"/>
    
      <category term="Struts2" scheme="http://lulee007.gitcafe.io/tagsCN/Struts2/"/>
    
      <category term="UnitTest" scheme="http://lulee007.gitcafe.io/tagsCN/UnitTest/"/>
    
      <category term="技术" scheme="http://lulee007.gitcafe.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[2016年度计划]]></title>
    <link href="http://lulee007.gitcafe.io/2016/01/10/2016%E5%B9%B4%E5%BA%A6%E8%AE%A1%E5%88%92/"/>
    <id>http://lulee007.gitcafe.io/2016/01/10/2016年度计划/</id>
    <published>2016-01-10T13:45:22.000Z</published>
    <updated>2016-01-12T05:46:15.000Z</updated>
    <content type="html"><![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>自从毕业后到现在2年半了的时间了，感觉一直忙忙碌碌的工作、生活，从来都没有进行过年度规划。从学校到工作，接触到了很多东西：<br>C# PHP（Yii框架，ThinkPhp），Mongodb，Arcgis，ArcEngine，Android，Web，SSM，iOS，Windows Phone，Python，Html5 Hybrid App 。<br>看得很多，总结的很少。<br>最近正着手把之前在工作学习中的记下来笔记整理一下，也是对工作学习到现在的一个『交代』。新年伊始，已经过去了三十六分之一左右了，得约束下自己，先给自己列一个计划。<br><a id="more"></a></p>
<h2 id="u6E90_u7801_u5B66_u4E60"><a href="#u6E90_u7801_u5B66_u4E60" class="headerlink" title="源码学习"></a>源码学习</h2><p>平时在github上看到不少很棒的开源代码，也用了其中的一部分，但仅限于此。我觉得还不够，知其然还得知其所以然。<a href="https://github.com/ibireme/YYKit" target="_blank" rel="external">YYKit</a>的作者<a href="https://github.com/ibireme" target="_blank" rel="external">ibireme</a>这个大神很牛逼啊。在devtang对他得专访他说的：</p>
<blockquote>
<p>我接触 iOS 开发的时间很早，但是一直都是在工作之余靠着兴趣自学的。14 年我还在人人网时，部门内部有个新项目需要 iOS 开发，我才得以有机会在工作中使用 iOS 相关的技术。全职转为 iOS 开发后，<strong><em>我花费了大量的时间阅读和学习各种开源的代码、研究其中的实现原理、尝试自己实现相关技术、尝试在工作中使用，这使得我在 iOS 开发技术上进步很快</em></strong>。对于 iOS 开发来说，我觉得自学能力是很重要的。<strong><em>主动去研究一些优秀的开源项目、多在工作中实践和学习，这样就能逐步提升个人技术水平了</em></strong>。</p>
</blockquote>
<p>更加激励我也要这样去努力。</p>
<h3 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h3><ul>
<li>SDWebImage</li>
<li>YYKit</li>
<li>Mantle</li>
<li>MJRefresh</li>
</ul>
<h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><p><a href="http://a.codekk.com/" target="_blank" rel="external">源码解析网站</a>经常发布一些开源项目的源代码解析</p>
<ul>
<li>Glide</li>
<li>android-Ultra-Pull-To-Refresh</li>
<li>NineOldAnimations</li>
<li>FlycoTabLayout</li>
</ul>
<h2 id="UWP__u5F00_u53D1Universal_Windows__u5E94_u7528"><a href="#UWP__u5F00_u53D1Universal_Windows__u5E94_u7528" class="headerlink" title="UWP 开发Universal Windows 应用"></a>UWP 开发Universal Windows 应用</h2><p>通用 Windows 平台 (UWP) 应用是一种基于通用 Windows 平台 (UWP) 生成的 Windows 体验<br>最近windows10份额也在逐渐增长，有机会尝试把之前的windows phone8 app转为UWP的。</p>
<h2 id="u8BFB_u4E66"><a href="#u8BFB_u4E66" class="headerlink" title="读书"></a>读书</h2><p>书读的少，一直静不下来。<br>小说类：</p>
<ul>
<li>三体全集</li>
<li>乖，摸摸头</li>
<li>阿弥陀佛 么么哒<br>管理类：</li>
<li>带队伍、抓执行</li>
</ul>
<h2 id="u535A_u5BA2"><a href="#u535A_u5BA2" class="headerlink" title="博客"></a>博客</h2><p>每月至少一篇</p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>自从毕业后到现在2年半了的时间了，感觉一直忙忙碌碌的工作、生活，从来都没有进行过年度规划。从学校到工作，接触到了很多东西：<br>C# PHP（Yii框架，ThinkPhp），Mongodb，Arcgis，ArcEngine，Android，Web，SSM，iOS，Windows Phone，Python，Html5 Hybrid App 。<br>看得很多，总结的很少。<br>最近正着手把之前在工作学习中的记下来笔记整理一下，也是对工作学习到现在的一个『交代』。新年伊始，已经过去了三十六分之一左右了，得约束下自己，先给自己列一个计划。<br>]]>
    
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hexo常用命令笔记]]></title>
    <link href="http://lulee007.gitcafe.io/2016/01/09/Hexo%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AC%94%E8%AE%B0/"/>
    <id>http://lulee007.gitcafe.io/2016/01/09/Hexo常用命令笔记/</id>
    <published>2016-01-09T04:20:23.000Z</published>
    <updated>2016-01-09T06:17:17.000Z</updated>
    <content type="html"><![CDATA[<p>参考：<a href="http://segmentfault.com/a/1190000002632530" target="_blank" rel="external">http://segmentfault.com/a/1190000002632530</a></p>
<h2 id="hexo_u5B89_u88C5_u5347_u7EA7"><a href="#hexo_u5B89_u88C5_u5347_u7EA7" class="headerlink" title="hexo安装升级"></a>hexo安装升级</h2><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">npm</span> install hexo -g <span class="comment">#安装  </span></span><br><span class="line"><span class="built_in">npm</span> update hexo -g <span class="comment">#升级  </span></span><br><span class="line">hexo init <span class="comment">#初始化</span></span><br></pre></td></tr></table></figure>
<h2 id="u5E38_u7528_u7B80_u5199"><a href="#u5E38_u7528_u7B80_u5199" class="headerlink" title="常用简写"></a>常用简写</h2><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo n <span class="string">"我的博客"</span> == hexo <span class="keyword">new</span> <span class="string">"我的博客"</span> <span class="preprocessor">#新建文章</span></span><br><span class="line">hexo p == hexo publish</span><br><span class="line">hexo g == hexo generate<span class="preprocessor">#生成</span></span><br><span class="line">hexo s == hexo <span class="keyword">server</span> <span class="preprocessor">#启动服务预览</span></span><br><span class="line">hexo d == hexo deploy<span class="preprocessor">#部署</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="u542F_u52A8_u672C_u5730_u670D_u52A1"><a href="#u542F_u52A8_u672C_u5730_u670D_u52A1" class="headerlink" title="启动本地服务"></a>启动本地服务</h2><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="keyword">server</span> <span class="preprocessor">#Hexo #会监视文件变动并自动更新，您无须重启服务器。</span></span><br><span class="line">hexo <span class="keyword">server</span> -s <span class="preprocessor">#静态模式</span></span><br><span class="line">hexo <span class="keyword">server</span> -p <span class="number">5000</span> <span class="preprocessor">#更改端口</span></span><br><span class="line">hexo <span class="keyword">server</span> -i <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span> <span class="preprocessor">#自定义 IP</span></span><br></pre></td></tr></table></figure>
<h2 id="u76D1_u89C6_u6587_u4EF6_u53D8_u52A8"><a href="#u76D1_u89C6_u6587_u4EF6_u53D8_u52A8" class="headerlink" title="监视文件变动"></a>监视文件变动</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">hexo</span> generate <span class="comment">#使用 Hexo 生成静态文件快速而且简单</span></span><br><span class="line">hexo generate --watch <span class="comment">#监视文件变动</span></span><br><span class="line">hexo clean <span class="comment">#清除缓存 网页正常情况下可以忽略此条命令</span></span><br></pre></td></tr></table></figure>
<h2 id="u90E8_u7F72"><a href="#u90E8_u7F72" class="headerlink" title="部署"></a>部署</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#两个命令的作用是相同的</span><br><span class="line">hexo <span class="keyword">generate</span> --deploy</span><br><span class="line">hexo deploy --<span class="keyword">generate</span></span><br><span class="line">hexo deploy -<span class="keyword">g</span></span><br><span class="line">hexo server -<span class="keyword">g</span></span><br></pre></td></tr></table></figure>
<h2 id="u8349_u7A3F"><a href="#u8349_u7A3F" class="headerlink" title="草稿"></a>草稿</h2><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># 新建草稿</span></span><br><span class="line">hexo <span class="keyword">new</span> draft &lt;title&gt;</span><br><span class="line"><span class="preprocessor"># 发布草稿为post</span></span><br><span class="line">hexo publish draft &lt;title&gt;</span><br></pre></td></tr></table></figure>
<h2 id="u6A21_u7248"><a href="#u6A21_u7248" class="headerlink" title="模版"></a>模版</h2><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="keyword">new</span> <span class="string">"postName"</span> <span class="preprocessor">#新建文章</span></span><br><span class="line">hexo <span class="keyword">new</span> page <span class="string">"pageName"</span> <span class="preprocessor">#新建页面</span></span><br><span class="line">hexo generate <span class="preprocessor">#生成静态页面至public目录</span></span><br><span class="line">hexo <span class="keyword">server</span> <span class="preprocessor">#开启预览访问端口（默认端口4000，'ctrl + c'关闭server）</span></span><br><span class="line">hexo deploy <span class="preprocessor">#将.deploy目录部署到GitHub</span></span><br><span class="line"></span><br><span class="line">hexo <span class="keyword">new</span> [layout] &lt;title&gt;</span><br><span class="line">hexo <span class="keyword">new</span> photo <span class="string">"My Gallery"</span></span><br><span class="line">hexo <span class="keyword">new</span> <span class="string">"Hello World"</span> --lang tw</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>变量</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>layout</td>
<td>布局</td>
</tr>
<tr>
<td>title</td>
<td>标题</td>
</tr>
<tr>
<td>date</td>
<td>文件建立日期</td>
</tr>
</tbody>
</table>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">title</span>: <span class="string">使用Hexo搭建个人博客</span></span><br><span class="line"><span class="attribute">layout</span>: <span class="string">post</span></span><br><span class="line"><span class="attribute">date</span>: <span class="string">2014-03-03 19:07:43</span></span><br><span class="line"><span class="attribute">comments</span>: <span class="string">true</span></span><br><span class="line"><span class="attribute">categories</span>: <span class="string">Blog</span></span><br><span class="line"><span class="attribute">tags</span>: <span class="string">[Hexo]</span></span><br><span class="line"><span class="attribute">keywords</span>: <span class="string">Hexo, Blog</span></span><br><span class="line"><span class="attribute">description</span>: <span class="string">生命在于折腾，又把博客折腾到Hexo了。给Hexo点赞。</span></span><br></pre></td></tr></table></figure>
<h2 id="u6A21_u7248_uFF08Scaffold_uFF09"><a href="#u6A21_u7248_uFF08Scaffold_uFF09" class="headerlink" title="模版（Scaffold）"></a>模版（Scaffold）</h2><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="keyword">new</span> photo <span class="string">"My Gallery"</span></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>变量</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>layout</td>
<td>布局</td>
</tr>
<tr>
<td>title</td>
<td>标题</td>
</tr>
<tr>
<td>date</td>
<td>文件建立日期</td>
</tr>
</tbody>
</table>
<h2 id="u8BBE_u7F6E_u6587_u7AE0_u6458_u8981"><a href="#u8BBE_u7F6E_u6587_u7AE0_u6458_u8981" class="headerlink" title="设置文章摘要"></a>设置文章摘要</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#以上是文章摘要</span><br><span class="line"><span class="comment">&lt;!--more--&gt;</span></span><br><span class="line">#以下是余下全文</span><br></pre></td></tr></table></figure>
<h2 id="u5199_u4F5C"><a href="#u5199_u4F5C" class="headerlink" title="写作"></a>写作</h2><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="built_in">new</span> page &lt;title&gt;</span><br><span class="line">hexo <span class="built_in">new</span> <span class="built_in">post</span> &lt;title&gt;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>变量</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>:title</td>
<td>标题</td>
</tr>
<tr>
<td>:year</td>
<td>建立的年份（4 位数）</td>
</tr>
<tr>
<td>:month</td>
<td>建立的月份（2 位数）</td>
</tr>
<tr>
<td>:i_month</td>
<td>建立的月份（去掉开头的零）</td>
</tr>
<tr>
<td>:day</td>
<td>建立的日期（2 位数）</td>
</tr>
<tr>
<td>:i_day</td>
<td>建立的日期（去掉开头的零）</td>
</tr>
</tbody>
</table>
<h2 id="u63A8_u9001_u5230_u670D_u52A1_u5668_u4E0A"><a href="#u63A8_u9001_u5230_u670D_u52A1_u5668_u4E0A" class="headerlink" title="推送到服务器上"></a>推送到服务器上</h2><p>一般步骤：<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="keyword">n</span> #写文章</span><br><span class="line">hexo <span class="keyword">g</span> #生成</span><br><span class="line">hexo <span class="keyword">d</span> #部署 #可与hexo <span class="keyword">g</span>合并为 hexo <span class="keyword">d</span> -<span class="keyword">g</span></span><br></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>参考：<a href="http://segmentfault.com/a/1190000002632530">http://segmentfault.com/a/1190000002632530</a></p>
<h2 id="hexo_u5B89_u88C5_u5347_u7EA7"><a href="#hexo_u5B89_u88C5_u5347_u7EA7" class="headerlink" title="hexo安装升级"></a>hexo安装升级</h2><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">npm</span> install hexo -g <span class="comment">#安装  </span></span><br><span class="line"><span class="built_in">npm</span> update hexo -g <span class="comment">#升级  </span></span><br><span class="line">hexo init <span class="comment">#初始化</span></span><br></pre></td></tr></table></figure>
<h2 id="u5E38_u7528_u7B80_u5199"><a href="#u5E38_u7528_u7B80_u5199" class="headerlink" title="常用简写"></a>常用简写</h2><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo n <span class="string">"我的博客"</span> == hexo <span class="keyword">new</span> <span class="string">"我的博客"</span> <span class="preprocessor">#新建文章</span></span><br><span class="line">hexo p == hexo publish</span><br><span class="line">hexo g == hexo generate<span class="preprocessor">#生成</span></span><br><span class="line">hexo s == hexo <span class="keyword">server</span> <span class="preprocessor">#启动服务预览</span></span><br><span class="line">hexo d == hexo deploy<span class="preprocessor">#部署</span></span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="Hexo" scheme="http://lulee007.gitcafe.io/tagsCN/Hexo/"/>
    
      <category term="命令" scheme="http://lulee007.gitcafe.io/tagsCN/%E5%91%BD%E4%BB%A4/"/>
    
      <category term="笔记" scheme="http://lulee007.gitcafe.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hexo博客优化配置]]></title>
    <link href="http://lulee007.gitcafe.io/2016/01/08/Hexo%E5%8D%9A%E5%AE%A2%E4%BC%98%E5%8C%96%E9%85%8D%E7%BD%AE/"/>
    <id>http://lulee007.gitcafe.io/2016/01/08/Hexo博客优化配置/</id>
    <published>2016-01-08T04:13:10.000Z</published>
    <updated>2016-01-18T05:45:24.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h3><p>记录一下搭建此博客期间的做的优化配置：</p>
<ul>
<li>语言配置</li>
<li>访问统计</li>
<li>分享</li>
<li>评论</li>
<li>Rss</li>
<li>百度站内搜索</li>
<li>谷歌统计分析</li>
<li>谷歌站内搜索<a id="more"></a>
<h3 id="u8BED_u8A00_u914D_u7F6E"><a href="#u8BED_u8A00_u914D_u7F6E" class="headerlink" title="语言配置"></a>语言配置</h3><code>_config.yml</code>中的<code>language</code>要配置为选定的主题<code>yilia</code>文件夹下的<code>language</code>目录下的文件，如：<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">language</span>: <span class="string">zh-Hans</span></span><br><span class="line"><span class="attribute">language</span>: <span class="string">en</span></span><br><span class="line"><span class="attribute">language</span>: <span class="string">zh-hk</span></span><br><span class="line"><span class="attribute">language</span>: <span class="string">zh-tw</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>这里修改 <code>zh-Hans</code>为标准的<code>zh-cn</code>,并添加一些汉化内容<br>语言配置用法:<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># 不带参数的</span></span><br><span class="line">__(<span class="string">'xxxx'</span>)</span><br><span class="line"><span class="preprocessor"># 带参数的</span></span><br><span class="line">_p(<span class="string">'xxx'</span>,xx)</span><br></pre></td></tr></table></figure></p>
<h3 id="u535A_u5BA2_u8BBF_u95EE_u7EDF_u8BA1"><a href="#u535A_u5BA2_u8BBF_u95EE_u7EDF_u8BA1" class="headerlink" title="博客访问统计"></a>博客访问统计</h3><h4 id="u4E0D_u849C_u5B50_u7EDF_u8BA1_u663E_u793A"><a href="#u4E0D_u849C_u5B50_u7EDF_u8BA1_u663E_u793A" class="headerlink" title="不蒜子统计显示"></a>不蒜子统计显示</h4><p>添加站点统计配置为<a href="http://busuanzi.ibruce.info/" target="_blank" rel="external">不蒜子</a>统计，并且可开关<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">busuanzi:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></p>
<h4 id="u767E_u5EA6_u7EDF_u8BA1"><a href="#u767E_u5EA6_u7EDF_u8BA1" class="headerlink" title="百度统计"></a>百度统计</h4><p><strong>更新:</strong> 百度统计,提示DNS无法解析IP错误,暂时无法使用</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">baidu_tongji:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="u5206_u4EAB"><a href="#u5206_u4EAB" class="headerlink" title="分享"></a>分享</h3><p>配置自己的分享</p>
<h4 id="u56FD_u5185_u7684jiathis"><a href="#u56FD_u5185_u7684jiathis" class="headerlink" title="国内的jiathis"></a>国内的jiathis</h4><p>将<code>themes/yilia/_partial/share_jia.ejs</code>中的内容替换为：<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"jiathis_style"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">span</span> <span class="attribute">class</span>=<span class="value">"jiathis_txt"</span>&gt;</span></span>&lt;%=<span class="ruby"> _<span class="number">_</span>(<span class="string">'post.share'</span>) </span>%&gt;<span class="xml">: &amp;nbsp; <span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">a</span> <span class="attribute">class</span>=<span class="value">"jiathis_button_weixin"</span>&gt;</span>微信<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">a</span> <span class="attribute">class</span>=<span class="value">"jiathis_button_cqq"</span>&gt;</span>QQ好友<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">a</span> <span class="attribute">class</span>=<span class="value">"jiathis_button_qzone"</span>&gt;</span>QQ空间<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">a</span> <span class="attribute">class</span>=<span class="value">"jiathis_button_tsina"</span>&gt;</span>新浪微博<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"http://www.jiathis.com/share?uid=2080230"</span> <span class="attribute">class</span>=<span class="value">"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis"</span> <span class="attribute">target</span>=<span class="value">"_blank"</span>&gt;</span>更多<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">a</span> <span class="attribute">class</span>=<span class="value">"jiathis_counter_style"</span>&gt;</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"http://v3.jiathis.com/code/jia.js?uid=2080230"</span> <span class="attribute">charset</span>=<span class="value">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>其中<code>uid</code>为自己在<a href="/www.jiathis.com">jiathis</a>注册的<code>uid</code></p>
<h4 id="u56FD_u5916_u7684addthis"><a href="#u56FD_u5916_u7684addthis" class="headerlink" title="国外的addthis"></a>国外的addthis</h4><p>将<code>themes/yilia/_partial/share_jia.ejs</code>中的内容替换为：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Go to www.addthis.com/dashboard to customize your tools --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"addthis_sharing_toolbox"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"http://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-568f54bcfd6a7b04"</span> <span class="attribute">async</span>=<span class="value">"async"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>其中<code>pubid</code>为在<a href="https://www.addthis.com/" target="_blank" rel="external">addthis</a>自己注册的<code>pubid</code></p>
<h3 id="u8BC4_u8BBA"><a href="#u8BC4_u8BBA" class="headerlink" title="评论"></a>评论</h3><p>配置多说<br>注册登录<a href="http://duoshuo.com/" target="_blank" rel="external">多说</a>点击进入后台管理，然后添加一个新的站点，<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20160108-1%402x.png" alt="addproject"></p>
<p>记住其中的shotname</p>
<p><img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20160108-3%402x.png" alt="filldetail"><br>然后填写到<code>themes/yilia/_config.yml</code>的<code>duoshuo: lulee007blog</code>即可。</p>
<h3 id="Rss"><a href="#Rss" class="headerlink" title="Rss"></a>Rss</h3><p>添加Rss，需要先安装rss生成模块：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="operator"><span class="keyword">install</span> hexo-generator-feed <span class="comment">--save</span></span></span><br></pre></td></tr></table></figure></p>
<p>然后在<code>themes/yilia/_config.yml</code>开启rss<br><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">rss</span>: <span class="string">/atom.xml</span></span><br></pre></td></tr></table></figure></p>
<h3 id="u6DFB_u52A0_u7AD9_u70B9_u5730_u56FE_u63D2_u4EF6"><a href="#u6DFB_u52A0_u7AD9_u70B9_u5730_u56FE_u63D2_u4EF6" class="headerlink" title="添加站点地图插件"></a>添加站点地图插件</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="operator"><span class="keyword">install</span> hexo-generator-sitmap <span class="comment">--save</span></span></span><br></pre></td></tr></table></figure>
<p>会在每次<code>hexo generator</code>后自动生成到网站根目录</p>
<h3 id="u6DFB_u52A0_u6587_u7AE0_u76EE_u5F55"><a href="#u6DFB_u52A0_u6587_u7AE0_u76EE_u5F55" class="headerlink" title="添加文章目录"></a>添加文章目录</h3><p>添加文章目录功能到 yilia 主题中</p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h3><p>记录一下搭建此博客期间的做的优化配置：</p>
<ul>
<li>语言配置</li>
<li>访问统计</li>
<li>分享</li>
<li>评论</li>
<li>Rss</li>
<li>百度站内搜索</li>
<li>谷歌统计分析</li>
<li>谷歌站内搜索]]>
    
    </summary>
    
      <category term="Hexo" scheme="http://lulee007.gitcafe.io/tagsCN/Hexo/"/>
    
      <category term="配置" scheme="http://lulee007.gitcafe.io/tagsCN/%E9%85%8D%E7%BD%AE/"/>
    
      <category term="笔记" scheme="http://lulee007.gitcafe.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Mac下使用Github与Hexo搭建静态博客]]></title>
    <link href="http://lulee007.gitcafe.io/2016/01/07/Mac%E4%B8%8B%E4%BD%BF%E7%94%A8Github%E4%B8%8EHexo%E6%90%AD%E5%BB%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/"/>
    <id>http://lulee007.gitcafe.io/2016/01/07/Mac下使用Github与Hexo搭建静态博客/</id>
    <published>2016-01-07T11:55:30.000Z</published>
    <updated>2016-01-16T07:08:36.000Z</updated>
    <content type="html"><![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>从今年的一月七号开始,看到好友<a href="/">老孙</a>在搞自己的 Hexo 博客,弄的挺起劲的。心生好奇也想搞搞,<br>加之之前也在工作学习中看到不少人都有在自己的博客中发布一些自己的学习工作心得,然后自己 google 了一番<br>发现眼前一亮,从去年年初开始就一直在用 markdown 做笔记,都是把工作学习中的笔记写在<code>Wiz笔记</code>里的，但是<br>记在笔记里的终究不是用来分享。这次这个 Hexo 静态网页博客正好支持 markdown ,加上支持<br>发布到 github 和 gitcafe 上,不用花钱申请域名,也不用申请存储空前,所有文章通过 markdown 来编写,然后渲染成网页<br>文章也很方便撰写，保存，跨平台，迁移方便。果断进行了折腾^_^。<br>于是进行 google ，找了一些教程来搭建一个个人静态博客。<br>其间看到阮一峰的一篇<a href="http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html" target="_blank" rel="external">博文</a>中提到的,<br>喜欢写Blog的人会经历三个阶段:</p>
<blockquote>
<p>第一阶段，刚接触Blog，觉得很新鲜，试着选择一个免费空间来写。<br>第二阶段，发现免费空间限制太多，就自己购买域名和空间，搭建独立博客。<br>第三阶段，觉得独立博客的管理太麻烦，最好在保留控制权的前提下，让别人来管，自己只负责写文章。</p>
</blockquote>
<p>哈哈，感觉说到了心坎。</p>
<p>然后在知乎上看到一个讨论『<a href="https://www.zhihu.com/question/20962496" target="_blank" rel="external">如何在 GitHub 上写博客？</a>』，里面的cnfeat总结的博客搭建过程，其中他的一篇《<a href="http://zhuanlan.zhihu.com/cnfeat/19743861" target="_blank" rel="external">为什么你要写博客？</a>》列出了一个博客的值得写的原因：</p>
<blockquote>
<ol>
<li>重新认识自己  </li>
<li>提供持续学习的动力  </li>
<li>积累更多的知识  </li>
<li>提高将事情讲清楚的能力  </li>
<li>分享带来的连锁反应  </li>
<li>帮你找到志同道合的人  </li>
<li>记录成长  </li>
<li>培养持续做一件事情的能力  </li>
<li>讨论反思</li>
<li>搜寻到你意想不到东西</li>
<li>一个人在做一件属于自己的事</li>
<li>互联网的身份识别</li>
</ol>
</blockquote>
<a id="more"></a>
<h2 id="u73AF_u5883_u642D_u5EFA"><a href="#u73AF_u5883_u642D_u5EFA" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>这里主要记录自己在mac下进行博客搭建的过程，主要通过Terminal来完成。<br>主要涉及到的hexo和github。其中hexo是基于nodejs，这里通过Terminal来安装。</p>
<blockquote>
<p>Installing Hexo is quite easy. However, you do need to have a couple of other things installed first:  </p>
<ul>
<li>Node.js  </li>
<li>Git</li>
</ul>
</blockquote>
<h3 id="u5B89_u88C5Node-js"><a href="#u5B89_u88C5Node-js" class="headerlink" title="安装Node.js"></a>安装Node.js</h3><p>安装nodejs最佳方式是通过nvm来安装</p>
<h4 id="u901A_u8FC7nvm_u5B89_u88C5"><a href="#u901A_u8FC7nvm_u5B89_u88C5" class="headerlink" title="通过nvm安装"></a>通过nvm安装</h4><p>通过cUrl安装nvm：<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl  http<span class="variable">s:</span>//raw.github.<span class="keyword">com</span>/creationix/nvm/master/install.<span class="keyword">sh</span> | <span class="keyword">sh</span></span><br></pre></td></tr></table></figure></p>
<p>Once nvm is installed, restart the terminal and run the following command to install Node.js.<br>当nvm安装完成后，关闭terminal 然后再重新打开，并输入以下命令来安装Node.js:<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm <span class="keyword">install</span> <span class="number">4</span></span><br></pre></td></tr></table></figure></p>
<h4 id="u901A_u8FC7_u5B89_u88C5_u5305_u6765_u5B89_u88C5"><a href="#u901A_u8FC7_u5B89_u88C5_u5305_u6765_u5B89_u88C5" class="headerlink" title="通过安装包来安装"></a>通过安装包来安装</h4><p>直接在<a href="http://nodejs.org/" target="_blank" rel="external">官网</a>下载并运行<a href="https://nodejs.org/dist/v5.4.0/node-v5.4.0.pkg" target="_blank" rel="external">安装包v5.4.0 Stable</a></p>
<h2 id="u5B89_u88C5Hexo"><a href="#u5B89_u88C5Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h2><p>当Node.js安装完成后，这时就可以通过npm来安装hexo了：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="operator"><span class="keyword">install</span> -<span class="keyword">g</span> hexo-cli</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>You may encounter some problems when compiling. Please install Xcode from App Store first. After Xcode is installed, open Xcode and go to Preferences -&gt; Download -&gt; Command Line Tools -&gt; Install to install command line tools.  </p>
</blockquote>
<p>如果在安装过程中编译出现了问题，请先从App Store安装Xcode，安装完Xcode后打开Xcode打开菜单栏 Preferences -&gt; Download -&gt; Command Line Tools -&gt; Install来安装xcode命令行工具。<br>或者直接通过命令行进行安装：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcode-<span class="built_in">select</span> <span class="comment">--install</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Hexo_u521D_u59CB_u5316_u914D_u7F6E"><a href="#Hexo_u521D_u59CB_u5316_u914D_u7F6E" class="headerlink" title="Hexo初始化配置"></a>Hexo初始化配置</h2><p>这里参考了:  </p>
<ul>
<li>wsgzao的<a href="http://wsgzao.github.io/post/hexo-guide/" target="_blank" rel="external">使用GitHub和Hexo搭建免费静态Blog</a>  </li>
<li>zipperary的<a href="http://zipperary.com/2013/05/29/hexo-guide-3/" target="_blank" rel="external">hexo系列教程</a></li>
</ul>
<h3 id="u521D_u59CB_u5316hexo"><a href="#u521D_u59CB_u5316hexo" class="headerlink" title="初始化hexo"></a>初始化hexo</h3><p>在Terminal里切换到一个空的目录下，我们将用来初始化hexo，假设我们选择的目录是<code>hexo</code><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将会在我们的`hexo`目录下生成一个新的文件夹`blog`</span></span><br><span class="line">hexo init blog</span><br><span class="line"><span class="comment"># 切换到新生成的blog目录下</span></span><br><span class="line"><span class="built_in">cd</span> blog</span><br><span class="line"><span class="comment"># 安装hexo的依赖项</span></span><br><span class="line">hexo install</span><br></pre></td></tr></table></figure></p>
<p>最终会得到以下的目录结构<br><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── _config.yml</span><br><span class="line">├── package.json</span><br><span class="line">├── scaffolds</span><br><span class="line">├── scripts</span><br><span class="line">├── source</span><br><span class="line"><span class="string">|      ├── _drafts</span></span><br><span class="line"><span class="string">|      └── _posts</span></span><br><span class="line">└── themes</span><br></pre></td></tr></table></figure></p>
<h3 id="u672C_u5730_u67E5_u770B"><a href="#u672C_u5730_u67E5_u770B" class="headerlink" title="本地查看"></a>本地查看</h3><p>现在我们已经搭建起本地的hexo博客了，在我们的<code>blog</code>目录下执行以下命令，然后到浏览器输入<a href="http://localhost:4000" target="_blank" rel="external">http://localhost:4000</a> 看看效果。<br><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo generate</span><br><span class="line">hexo <span class="keyword">server</span></span><br></pre></td></tr></table></figure></p>
<p>至此我们的本地博客就搭建好了。</p>
<h2 id="u521B_u5EFA_u4E00_u4E2AGithub_Repository"><a href="#u521B_u5EFA_u4E00_u4E2AGithub_Repository" class="headerlink" title="创建一个Github Repository"></a>创建一个Github Repository</h2><p>在自己Github主页右下角，创建一个新的repository。比如我的Github账号是<code>lulee007</code>，那么我应该创建的repository名字应该是<code>lulee.github.io</code>。</p>
<h2 id="u914D_u7F6EGithu_SSH_keys"><a href="#u914D_u7F6EGithu_SSH_keys" class="headerlink" title="配置Githu SSH keys"></a>配置Githu SSH keys</h2><p>因为目前已经在使用Github,而且注册也比较简单，也可以参考：<a href="http://pchou.info/web-build/2013/01/03/build-github-blog-page-01.html" target="_blank" rel="external">一步步在GitHub上创建博客主页 全系列</a>by pchou，所以直接说一下SSH keys的配置。</p>
<blockquote>
<p>SSH keys are a way to identify trusted computers, without involving passwords.</p>
</blockquote>
<p>利用ssh keys 可以直接和github建立链接而不必每次pull request都输入用户名密码。<br>有英语阅读能力的直接参考官方的<a href="https://help.github.com/articles/generating-ssh-keys/" target="_blank" rel="external">Generating SSH keys</a>。里面讲的很详细，包括如何利用已有的ssh keys，加入到github上。</p>
<h2 id="u90E8_u7F72"><a href="#u90E8_u7F72" class="headerlink" title="部署"></a>部署</h2><h3 id="u4FEE_u6539Hexo_u914D_u7F6E"><a href="#u4FEE_u6539Hexo_u914D_u7F6E" class="headerlink" title="修改Hexo配置"></a>修改Hexo配置</h3><p>要部署到github上需要修改Hexo的<code>_config.yml</code>，<code>_config.yml</code>在<code>blog</code>目录下，要把下面的<code>lulee007</code>都换成你的账号名：<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">deploy</span>:</span><br><span class="line">  <span class="attribute">type</span>: git</span><br><span class="line">  <span class="attribute">repository</span>: git<span class="variable">@github</span>.<span class="attribute">com</span>:lulee007/lulee007.github.io.git</span><br><span class="line">  <span class="attribute">branch</span>: master</span><br></pre></td></tr></table></figure></p>
<p><strong><em>注意：</em></strong> 每个冒号后面都要有一个空格<br><code>repository</code> 这个链接也可以直接在github上复制：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/blog_pic_QQ20160108-0%402x.png" alt="copyssh"></p>
<h3 id="u5B89_u88C5git_u63D2_u4EF6_u5230hexo_u4E2D"><a href="#u5B89_u88C5git_u63D2_u4EF6_u5230hexo_u4E2D" class="headerlink" title="安装git插件到hexo中"></a>安装git插件到hexo中</h3><p>由于默认hexo没有没安装此插件，所以得手动安装<br>在Terminal中在<code>blog</code>目录下输入：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="operator"><span class="keyword">install</span> hexo-deployer-git <span class="comment">--save</span></span></span><br></pre></td></tr></table></figure></p>
<p>这样就安装好了git插件了，配合上面的配置，很方便就能把博客部署到github上。</p>
<h3 id="u90E8_u7F72_u5230github"><a href="#u90E8_u7F72_u5230github" class="headerlink" title="部署到github"></a>部署到github</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">hexo</span> generate</span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure>
<p><strong><em>注意：</em></strong>每次修改文章后，都需要执行：  </p>
<pre><code>hexo generate
</code></pre><p>这样才能把修改后的文章重新生成静态网页。<br>最后：<br>在浏览器访问lulee007.github.io就能看到你的成就了</p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>从今年的一月七号开始,看到好友<a href="/">老孙</a>在搞自己的 Hexo 博客,弄的挺起劲的。心生好奇也想搞搞,<br>加之之前也在工作学习中看到不少人都有在自己的博客中发布一些自己的学习工作心得,然后自己 google 了一番<br>发现眼前一亮,从去年年初开始就一直在用 markdown 做笔记,都是把工作学习中的笔记写在<code>Wiz笔记</code>里的，但是<br>记在笔记里的终究不是用来分享。这次这个 Hexo 静态网页博客正好支持 markdown ,加上支持<br>发布到 github 和 gitcafe 上,不用花钱申请域名,也不用申请存储空前,所有文章通过 markdown 来编写,然后渲染成网页<br>文章也很方便撰写，保存，跨平台，迁移方便。果断进行了折腾^_^。<br>于是进行 google ，找了一些教程来搭建一个个人静态博客。<br>其间看到阮一峰的一篇<a href="http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html">博文</a>中提到的,<br>喜欢写Blog的人会经历三个阶段:</p>
<blockquote>
<p>第一阶段，刚接触Blog，觉得很新鲜，试着选择一个免费空间来写。<br>第二阶段，发现免费空间限制太多，就自己购买域名和空间，搭建独立博客。<br>第三阶段，觉得独立博客的管理太麻烦，最好在保留控制权的前提下，让别人来管，自己只负责写文章。</p>
</blockquote>
<p>哈哈，感觉说到了心坎。</p>
<p>然后在知乎上看到一个讨论『<a href="https://www.zhihu.com/question/20962496">如何在 GitHub 上写博客？</a>』，里面的cnfeat总结的博客搭建过程，其中他的一篇《<a href="http://zhuanlan.zhihu.com/cnfeat/19743861">为什么你要写博客？</a>》列出了一个博客的值得写的原因：</p>
<blockquote>
<ol>
<li>重新认识自己  </li>
<li>提供持续学习的动力  </li>
<li>积累更多的知识  </li>
<li>提高将事情讲清楚的能力  </li>
<li>分享带来的连锁反应  </li>
<li>帮你找到志同道合的人  </li>
<li>记录成长  </li>
<li>培养持续做一件事情的能力  </li>
<li>讨论反思</li>
<li>搜寻到你意想不到东西</li>
<li>一个人在做一件属于自己的事</li>
<li>互联网的身份识别</li>
</ol>
</blockquote>]]>
    
    </summary>
    
      <category term="Github" scheme="http://lulee007.gitcafe.io/tagsCN/Github/"/>
    
      <category term="Hexo" scheme="http://lulee007.gitcafe.io/tagsCN/Hexo/"/>
    
      <category term="Mac" scheme="http://lulee007.gitcafe.io/tagsCN/Mac/"/>
    
      <category term="笔记" scheme="http://lulee007.gitcafe.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hello World]]></title>
    <link href="http://lulee007.gitcafe.io/2016/01/07/hello-world/"/>
    <id>http://lulee007.gitcafe.io/2016/01/07/hello-world/</id>
    <published>2016-01-07T11:28:47.000Z</published>
    <updated>2016-01-07T11:28:47.000Z</updated>
    <content type="html"><![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start"><a href="#Quick_Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create_a_new_post"><a href="#Create_a_new_post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server"><a href="#Run_server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files"><a href="#Generate_static_files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites"><a href="#Deploy_to_remote_sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Cordova+Ionic+AngularJs做混合移动App开发之--学习路线]]></title>
    <link href="http://lulee007.gitcafe.io/2015/10/23/Cordova-Ionic-Angularjs%E5%81%9A%E6%B7%B7%E5%90%88%E7%A7%BB%E5%8A%A8App%E5%BC%80%E5%8F%91%E4%B9%8B-%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/"/>
    <id>http://lulee007.gitcafe.io/2015/10/23/Cordova-Ionic-Angularjs做混合移动App开发之-学习路线/</id>
    <published>2015-10-23T12:59:23.000Z</published>
    <updated>2016-01-18T05:46:00.000Z</updated>
    <content type="html"><![CDATA[<h2 id="u73AF_u5883_u642D_u5EFA"><a href="#u73AF_u5883_u642D_u5EFA" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>参考另一篇：<a href="/lulee007.github.io/">Mac下安装cordova+ionic+angularjs做混合移动app开发</a></p>
<h2 id="u5E38_u89C4_u5F00_u53D1_uFF1A"><a href="#u5E38_u89C4_u5F00_u53D1_uFF1A" class="headerlink" title="常规开发："></a>常规开发：</h2><p>标准的mvc模式:</p>
<ul>
<li>m: 模型 service api获取数据</li>
<li>c: 控制器 controller</li>
<li>v: 视图 数据绑定，展示数据 html</li>
</ul>
<a id="more"></a>
<h2 id="u63D2_u4EF6_u5F00_u53D1_uFF1A"><a href="#u63D2_u4EF6_u5F00_u53D1_uFF1A" class="headerlink" title="插件开发："></a>插件开发：</h2><h2 id="u771F_u673A_u6A21_u62DF_u5668_u8C03_u8BD5"><a href="#u771F_u673A_u6A21_u62DF_u5668_u8C03_u8BD5" class="headerlink" title="真机模拟器调试"></a>真机模拟器调试</h2><h3 id="android"><a href="#android" class="headerlink" title="android"></a>android</h3><h3 id="ios"><a href="#ios" class="headerlink" title="ios"></a>ios</h3><h2 id="u5E38_u7528_u547D_u4EE4_uFF1A"><a href="#u5E38_u7528_u547D_u4EE4_uFF1A" class="headerlink" title="常用命令："></a>常用命令：</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 构建所有平台代码</span></span><br><span class="line">ionic build</span><br><span class="line"><span class="comment"># 构建Android</span></span><br><span class="line">ionic build android</span><br><span class="line"><span class="comment"># 构建ios 模拟器</span></span><br><span class="line">ionic build ios</span><br><span class="line"><span class="comment"># 构建ios 设备</span></span><br><span class="line">ionic build --device ios</span><br><span class="line"><span class="comment"># 运行app到设备上</span></span><br><span class="line">ionic run --device ios/android</span><br><span class="line"><span class="comment"># 运行在模拟器上（android genymotion 请用--device）</span></span><br><span class="line">ionic run --emulate ios/android</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启本地浏览器调试</span></span><br><span class="line">ionic serve</span><br><span class="line"><span class="comment"># 添加ios平台</span></span><br><span class="line">ionic platform add ios</span><br><span class="line"><span class="comment"># 移除android平台</span></span><br><span class="line">ionic platform remove android</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装插件 xxx可以为id，目录，url</span></span><br><span class="line">cordova plugin add xxx</span><br><span class="line"><span class="comment"># 移除插件 xxx只能为插件id</span></span><br><span class="line">cordova plugin remove xxxx</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="u73AF_u5883_u642D_u5EFA"><a href="#u73AF_u5883_u642D_u5EFA" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>参考另一篇：<a href="/lulee007.github.io/">Mac下安装cordova+ionic+angularjs做混合移动app开发</a></p>
<h2 id="u5E38_u89C4_u5F00_u53D1_uFF1A"><a href="#u5E38_u89C4_u5F00_u53D1_uFF1A" class="headerlink" title="常规开发："></a>常规开发：</h2><p>标准的mvc模式:</p>
<ul>
<li>m: 模型 service api获取数据</li>
<li>c: 控制器 controller</li>
<li>v: 视图 数据绑定，展示数据 html</li>
</ul>]]>
    
    </summary>
    
      <category term="AngularJs" scheme="http://lulee007.gitcafe.io/tagsCN/AngularJs/"/>
    
      <category term="Cordova" scheme="http://lulee007.gitcafe.io/tagsCN/Cordova/"/>
    
      <category term="HTML5" scheme="http://lulee007.gitcafe.io/tagsCN/HTML5/"/>
    
      <category term="Hybrid App" scheme="http://lulee007.gitcafe.io/tagsCN/Hybrid-App/"/>
    
      <category term="Ionic" scheme="http://lulee007.gitcafe.io/tagsCN/Ionic/"/>
    
      <category term="混合型移动应用" scheme="http://lulee007.gitcafe.io/tagsCN/%E6%B7%B7%E5%90%88%E5%9E%8B%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8/"/>
    
      <category term="笔记" scheme="http://lulee007.gitcafe.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Mac下cordova+ionic+angularjs做混合移动app开发之--安装环境配置]]></title>
    <link href="http://lulee007.gitcafe.io/2015/10/10/Mac%E4%B8%8BCordova-Ionic-AngularJs%E5%81%9A%E6%B7%B7%E5%90%88%E7%A7%BB%E5%8A%A8App%E5%BC%80%E5%8F%91%E4%B9%8B--%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
    <id>http://lulee007.gitcafe.io/2015/10/10/Mac下Cordova-Ionic-AngularJs做混合移动App开发之--安装环境配置/</id>
    <published>2015-10-10T11:49:59.000Z</published>
    <updated>2016-01-18T05:43:18.000Z</updated>
    <content type="html"><![CDATA[<h3 id="u5B89_u88C5Nodejs_3A"><a href="#u5B89_u88C5Nodejs_3A" class="headerlink" title="安装Nodejs:"></a>安装Nodejs:</h3><p>下载并打开<code>node-v0.12.4.pkg</code>进行安装</p>
<h3 id="u66F4_u6362nodejs__u7684npm_u5305_u7BA1_u7406_u5668_u7684_u6E90_uFF1A"><a href="#u66F4_u6362nodejs__u7684npm_u5305_u7BA1_u7406_u5668_u7684_u6E90_uFF1A" class="headerlink" title="更换nodejs 的npm包管理器的源："></a>更换<code>nodejs</code> 的<code>npm</code>包管理器的源：</h3><h4 id="u5B89_u88C5nodejs"><a href="#u5B89_u88C5nodejs" class="headerlink" title="安装nodejs"></a>安装<code>nodejs</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先移除之前的源，因为国内访问比较慢或者访问不了</span></span><br><span class="line">gem sources --remove https://rubygems.org/</span><br><span class="line"><span class="comment">#添加淘宝的镜像源</span></span><br><span class="line">gem sources <span class="operator">-a</span> http://ruby.taobao.org/</span><br><span class="line"><span class="comment">#查看一下有没有更新成功</span></span><br><span class="line">gem sources <span class="operator">-l</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="u5B89_u88C5cordova_u4EE5_u53CAionic"><a href="#u5B89_u88C5cordova_u4EE5_u53CAionic" class="headerlink" title="安装cordova以及ionic"></a>安装<code>cordova</code>以及<code>ionic</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用管理员权限，并安装cordova到全局位置</span></span><br><span class="line">sudo npm install -g cordova</span><br><span class="line"><span class="comment">#同样的，安装 ionic</span></span><br><span class="line">sudo npm install -g ionic</span><br></pre></td></tr></table></figure>
<h4 id="u5B89_u88C5ios_u771F_u673A_u8C03_u8BD5ios-deploy"><a href="#u5B89_u88C5ios_u771F_u673A_u8C03_u8BD5ios-deploy" class="headerlink" title="安装ios真机调试ios-deploy"></a>安装ios真机调试<code>ios-deploy</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#安装ios-deploy 到全局位置</span></span><br><span class="line">sudo npm install -g ios-deploy</span><br></pre></td></tr></table></figure>
<h4 id="u5B89_u88C5bower"><a href="#u5B89_u88C5bower" class="headerlink" title="安装bower"></a>安装<code>bower</code></h4><p><code>bower</code>是<code>node</code>的一个工具，安装<code>bower</code>用于管理browser端的前端资源<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install -g bower</span><br></pre></td></tr></table></figure></p>
<!-- more -->
<h3 id="u5B89_u88C5IntelliJ_IDEA"><a href="#u5B89_u88C5IntelliJ_IDEA" class="headerlink" title="安装IntelliJ IDEA"></a>安装IntelliJ IDEA</h3><ul>
<li>下载并打开<code>ideaIU-14.1.4.dmg</code>直接把<code>IntelliJ</code>拖入<code>Application</code>就可以了</li>
</ul>
<h3 id="u5B89_u88C5IntelliJ_IDEA_u63D2_u4EF6"><a href="#u5B89_u88C5IntelliJ_IDEA_u63D2_u4EF6" class="headerlink" title="安装IntelliJ IDEA插件"></a>安装IntelliJ IDEA插件</h3><p>需要常用的插件有：</p>
<ul>
<li>genymotion ,开发用的Android模拟器，速度应该是最快的了</li>
<li>markdown</li>
<li>ionic</li>
<li>cordova</li>
</ul>
<p><img src="http://7xjzst.com1.z0.glb.clouddn.com/gif_installplugins.gif" alt="Plugin安装截图"></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u5B89_u88C5Nodejs_3A"><a href="#u5B89_u88C5Nodejs_3A" class="headerlink" title="安装Nodejs:"></a>安装Nodejs:</h3><p>下载并打开<code>node-v0.12.4.pkg</code>进行安装</p>
<h3 id="u66F4_u6362nodejs__u7684npm_u5305_u7BA1_u7406_u5668_u7684_u6E90_uFF1A"><a href="#u66F4_u6362nodejs__u7684npm_u5305_u7BA1_u7406_u5668_u7684_u6E90_uFF1A" class="headerlink" title="更换nodejs 的npm包管理器的源："></a>更换<code>nodejs</code> 的<code>npm</code>包管理器的源：</h3><h4 id="u5B89_u88C5nodejs"><a href="#u5B89_u88C5nodejs" class="headerlink" title="安装nodejs"></a>安装<code>nodejs</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先移除之前的源，因为国内访问比较慢或者访问不了</span></span><br><span class="line">gem sources --remove https://rubygems.org/</span><br><span class="line"><span class="comment">#添加淘宝的镜像源</span></span><br><span class="line">gem sources <span class="operator">-a</span> http://ruby.taobao.org/</span><br><span class="line"><span class="comment">#查看一下有没有更新成功</span></span><br><span class="line">gem sources <span class="operator">-l</span></span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="AngularJs" scheme="http://lulee007.gitcafe.io/tagsCN/AngularJs/"/>
    
      <category term="Cordova" scheme="http://lulee007.gitcafe.io/tagsCN/Cordova/"/>
    
      <category term="HTML5" scheme="http://lulee007.gitcafe.io/tagsCN/HTML5/"/>
    
      <category term="Hybrid App" scheme="http://lulee007.gitcafe.io/tagsCN/Hybrid-App/"/>
    
      <category term="Ionic" scheme="http://lulee007.gitcafe.io/tagsCN/Ionic/"/>
    
      <category term="Mac" scheme="http://lulee007.gitcafe.io/tagsCN/Mac/"/>
    
      <category term="混合型移动应用" scheme="http://lulee007.gitcafe.io/tagsCN/%E6%B7%B7%E5%90%88%E5%9E%8B%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8/"/>
    
      <category term="笔记" scheme="http://lulee007.gitcafe.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Mac下Android Studio与Subversion集成的问题]]></title>
    <link href="http://lulee007.gitcafe.io/2015/06/28/Mac%E4%B8%8BAndroidStudio%E4%B8%8ESubversion%E9%9B%86%E6%88%90%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>http://lulee007.gitcafe.io/2015/06/28/Mac下AndroidStudio与Subversion集成的问题/</id>
    <published>2015-06-28T12:35:17.000Z</published>
    <updated>2016-01-11T13:12:32.000Z</updated>
    <content type="html"><![CDATA[<p>由于Mac10.10下的subversion版本是1.7，而使用smartsvn8.6 <code>checkout</code>版本提示需要<code>upgrade to 1.8</code><br>这样一来，使得android studio import 进来的svn项目无法使用集成好的subversion进行管理了，会出现如下错误：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">svn: E155021: This client is too old to work  </span><br><span class="line">with the working copy at xxx (format <span class="string">'31'</span>)</span><br></pre></td></tr></table></figure></p>
<p>进过一番搜索得到的解决方法记录如下：<br><a id="more"></a></p>
<h2 id="u5347_u7EA7subversion"><a href="#u5347_u7EA7subversion" class="headerlink" title="升级subversion"></a><a name="updatesvn">升级subversion</a></h2><ul>
<li><p><a name="brewupdatesvn">通过brew升级subversion:</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install svn</span><br></pre></td></tr></table></figure>
<p>安装完成之后会有提示：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">==&gt; Summary</span><br><span class="line">🍺  /usr/<span class="built_in">local</span>/Cellar/subversion/<span class="number">1.8</span>.<span class="number">13</span>: <span class="number">116</span> files, <span class="number">9.4</span>M</span><br></pre></td></tr></table></figure>
<p>此时新的svn客户端被安装到<code>/usr/local/Cellar/subversion/1.8.13</code>目录下了。<br>查看原来svn的位置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">which</span> svn</span><br></pre></td></tr></table></figure>
<p>得到如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/bin/svn</span><br></pre></td></tr></table></figure>
<p>进入到这个<code>/usr/local/bin/svn</code>目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/bin/svn</span><br></pre></td></tr></table></figure>
<p>备份当前svn到<code>bak.svn</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir bak.svn</span><br><span class="line">mv svn* ./bak.svn</span><br></pre></td></tr></table></figure>
</li>
<li><p><a name="replacesvn">替换当前svn：</a><br>建立<code>/usr/local/Cellar/subversion/1.8.13</code>软连接到当前目录<code>usr/local/bin</code>  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln <span class="operator">-s</span> /usr/<span class="built_in">local</span>/Cellar/subversion/<span class="number">1.8</span>.<span class="number">11</span>/bin/svn* ./</span><br></pre></td></tr></table></figure>
<p>重新启动系统新的svn就可以用了。</p>
</li>
</ul>
<h2 id="u914D_u7F6Eandroid_studio"><a href="#u914D_u7F6Eandroid_studio" class="headerlink" title="配置android studio"></a><a name="setupas">配置android studio</a></h2><p>  打开android studio项目，从菜单栏里打开<code>android studio</code> &gt; <code>preferences</code>:<br>  <img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20150628-10@2x.png" alt="preferences"><br>  选择<code>Version Control</code>展开后选择<code>Subversion</code><br>  勾选 “Use command line client”并输入刚才通过命令<code>which svn</code>得到的svn的路径<code>/usr/local/bin/svn</code> 点击ok<br>  最终如下图所示：<br>  <img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20150628-11@2x.png" alt="setup"></p>
<h2 id="u542F_u7528android_studio_svn"><a href="#u542F_u7528android_studio_svn" class="headerlink" title="启用android studio svn"></a><a name="enablesvn">启用android studio svn</a></h2><p>  打开菜单 <code>VCS</code>&gt; <code>Enable Version Control Integration.</code>，这时就可以使用了。<br>  <img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20150628-12@2x.png" alt="enable svn">  </p>
<h2 id="u53C2_u8003"><a href="#u53C2_u8003" class="headerlink" title="参考"></a>参考</h2><ul>
<li>upgrade svn via brew<br><a href="http://blog.csdn.net/duanyipeng/article/details/44747689" target="_blank" rel="external">http://blog.csdn.net/duanyipeng/article/details/44747689</a></li>
<li>AndroidStudio svn 1.8<br><a href="http://stackoverflow.com/questions/25294420/svn-e155021-this-client-is-too-old-to-work-with-the-working-copy-at-xxx-forma" target="_blank" rel="external">http://stackoverflow.com/questions/25294420/svn-e155021-this-client-is-too-old-to-work-with-the-working-copy-at-xxx-forma</a></li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<p>由于Mac10.10下的subversion版本是1.7，而使用smartsvn8.6 <code>checkout</code>版本提示需要<code>upgrade to 1.8</code><br>这样一来，使得android studio import 进来的svn项目无法使用集成好的subversion进行管理了，会出现如下错误：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">svn: E155021: This client is too old to work  </span><br><span class="line">with the working copy at xxx (format <span class="string">'31'</span>)</span><br></pre></td></tr></table></figure></p>
<p>进过一番搜索得到的解决方法记录如下：<br>]]>
    
    </summary>
    
      <category term="Android Studio" scheme="http://lulee007.gitcafe.io/tagsCN/Android-Studio/"/>
    
      <category term="Mac" scheme="http://lulee007.gitcafe.io/tagsCN/Mac/"/>
    
      <category term="SVN" scheme="http://lulee007.gitcafe.io/tagsCN/SVN/"/>
    
      <category term="Subversion" scheme="http://lulee007.gitcafe.io/tagsCN/Subversion/"/>
    
      <category term="笔记" scheme="http://lulee007.gitcafe.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Mac10.10.3下AndroidStudio单元测试——instrumentation]]></title>
    <link href="http://lulee007.gitcafe.io/2015/06/21/Mac-10-10-3%E4%B8%8BAndroidStudio%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-instrumentation/"/>
    <id>http://lulee007.gitcafe.io/2015/06/21/Mac-10-10-3下AndroidStudio单元测试-instrumentation/</id>
    <published>2015-06-21T11:45:37.000Z</published>
    <updated>2016-01-11T12:55:30.000Z</updated>
    <content type="html"><![CDATA[<p>测试环境：</p>
<ul>
<li>Android Studio 1.2.2</li>
<li>Mac OS 10.10.3</li>
</ul>
<a id="more"></a>
<h2 id="u4EE3_u7801"><a href="#u4EE3_u7801" class="headerlink" title="代码"></a><a name="code">代码</a></h2><ol>
<li><p><a name="createclass">新建类代码：</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHelper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isNull</span><span class="params">(String a)</span></span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(a==<span class="keyword">null</span>)&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">      &#125;<span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">          <span class="keyword">return</span>  <span class="keyword">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLowCase</span><span class="params">(String a)</span></span>&#123;</span><br><span class="line">      <span class="keyword">return</span> a.toLowerCase().equals(a);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><a name="genTestClass">通过android studio 提示自动生成测试代码：<br>把光标移到类名称上，然后按组合键<code>alt</code>+<code>enter</code>，选择第一个<em>Create Test</em>如下图：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20150628-1@2x.png" alt="Create Test"><br>弹出生成测试类对话框，其中superclass选择<code>InstrumentationTestCase</code>，<br>勾选需要测试的方法,点击Ok后选择生成的目标package文件夹就可以了。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20150628-2@2x.png" alt="TestCase Dialog"><br>会在src/Androidtest package目录下生成对应的测试类<code>TestHelper</code></a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHelperTest</span> <span class="keyword">extends</span> <span class="title">InstrumentationTestCase</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testIsNull</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        TestHelper testHelper =<span class="keyword">new</span> TestHelper();</span><br><span class="line">        assertEquals(<span class="keyword">true</span>, testHelper.isNull(<span class="keyword">null</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testIsLowCase</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        TestHelper testHelper =<span class="keyword">new</span> TestHelper();</span><br><span class="line">        assertEquals(<span class="keyword">true</span>, testHelper.isLowCase(<span class="string">"C"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="u6D4B_u8BD5"><a href="#u6D4B_u8BD5" class="headerlink" title="测试"></a><a name="test">测试</a></h2><p>在android studio一排按钮的最上层，点击“运行”旁边的配置按钮，选择“edit configurations”<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20150628-3@2x.png" alt="run config"><br>在配置里点击新建按钮，添加“Android Test”<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20150628-4@2x.png" alt="add new config"><br>给Test添加一个名称Name:“MyTest”<br>选择Module为“app”<br>Test对象为“All in package”,并确认Package框里选择的是我们测试类的所在的包名。<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20150628-5@2x.png" alt="set config"><br>点击Ok后，点击菜单栏里的Run图标<br>等待启动完成后在输出栏里可以看到我们的测试结果：<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20150628-6@2x.png" alt="test resutl"><br>可以看到我们的测试结果有<em>Done:4 of 4 Failed:1</em> 一个错误，testIsLowCase 传入的时<code>C</code>不是小写字母。  </p>
<h2 id="u6DFB_u52A0_u6D4B_u8BD5"><a href="#u6DFB_u52A0_u6D4B_u8BD5" class="headerlink" title="添加测试"></a><a name="addtest">添加测试</a></h2><p>打开刚才的测试类TestHelper,添加一个方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addTest</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>将光标放到 addTest名称上，按组合键<code>alt</code>+<code>enter</code>选择 Generate missed test methods<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20150628-8@2x.png" alt="generate missed test mothod"><br>选择需要添加的TestMethod<br><img src="http://7xjzst.com1.z0.glb.clouddn.com/pic_QQ20150628-9@2x.png" alt="choose missed methods"><br>这时候会在TestHelperTest类里生成新的测试方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAddTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>添加好代码就可以进行测试了。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>测试环境：</p>
<ul>
<li>Android Studio 1.2.2</li>
<li>Mac OS 10.10.3</li>
</ul>]]>
    
    </summary>
    
      <category term="Android Studio" scheme="http://lulee007.gitcafe.io/tagsCN/Android-Studio/"/>
    
      <category term="Instrumentation" scheme="http://lulee007.gitcafe.io/tagsCN/Instrumentation/"/>
    
      <category term="Mac" scheme="http://lulee007.gitcafe.io/tagsCN/Mac/"/>
    
      <category term="Unit Test" scheme="http://lulee007.gitcafe.io/tagsCN/Unit-Test/"/>
    
      <category term="单元测试" scheme="http://lulee007.gitcafe.io/tagsCN/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"/>
    
      <category term="笔记" scheme="http://lulee007.gitcafe.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[CentOS5.5下安装Countly-Web-Server过程记录]]></title>
    <link href="http://lulee007.gitcafe.io/2015/06/12/CentOS-5-5%E4%B8%8B%E5%AE%89%E8%A3%85Countly-Web-Server%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/"/>
    <id>http://lulee007.gitcafe.io/2015/06/12/CentOS-5-5下安装Countly-Web-Server过程记录/</id>
    <published>2015-06-12T13:57:12.000Z</published>
    <updated>2016-01-11T13:03:02.000Z</updated>
    <content type="html"><![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>由于工作需要，需要在CentOS 5.5 下安装Countly Web Server，把过程记录下来</p>
<a id="more"></a>
<h2 id="1-__u7CFB_u7EDF_u66F4_u65B0_u4E0E_u4E2D_u6587_u8BED_u8A00_u5305_u5B89_u88C5"><a href="#1-__u7CFB_u7EDF_u66F4_u65B0_u4E0E_u4E2D_u6587_u8BED_u8A00_u5305_u5B89_u88C5" class="headerlink" title="1. 系统更新与中文语言包安装"></a>1. 系统更新与中文语言包安装</h2><h2 id="2-__u57FA_u672C_u73AF_u5883_u914D_u7F6E_uFF1A"><a href="#2-__u57FA_u672C_u73AF_u5883_u914D_u7F6E_uFF1A" class="headerlink" title="2. 基本环境配置："></a>2. 基本环境配置：</h2><h3 id="2-1-_NodeJS_u5B89_u88C5"><a href="#2-1-_NodeJS_u5B89_u88C5" class="headerlink" title="2.1. NodeJS安装"></a>2.1. NodeJS安装</h3><ol>
<li><p>依赖项安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ openssl-devel</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载并解压安装 nodejs</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line">wget –c http://nodejs.org/dist/v0.<span class="number">12.4</span>/node-v0.<span class="number">12.4</span>.tar.gz</span><br><span class="line">tar zxvf node-v0.<span class="number">12.4</span>.tar.gz</span><br><span class="line"><span class="built_in">cd</span> node-v0.<span class="number">12.4</span></span><br><span class="line">./configure --prefix=/usr/<span class="built_in">local</span>/nodejs</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>注意此时会有错误输出信息：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure  File <span class="string">"./configure"</span>, line <span class="number">442</span></span><br><span class="line">fpu = <span class="string">'vfpv3'</span> <span class="keyword">if</span> armv7 <span class="keyword">else</span> <span class="string">'vfpv2'</span></span><br><span class="line">^ <span class="built_in">SyntaxError</span>: invalid syntax</span><br></pre></td></tr></table></figure>
<p>这是因为Python当前版本 2.4.3 不够,需要升级Python</p>
</li>
<li><p>升级Python：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd /opt</span><br><span class="line">wget -c http:<span class="comment">//www.python.org/ftp/python/2.7.3/Python-2.7.3.tar.bz2</span></span><br><span class="line">tar jxvf Python-<span class="number">2.7</span><span class="number">.3</span>.tar.bz2</span><br><span class="line">cd Python-<span class="number">2.7</span><span class="number">.3</span></span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>正常情况下即使python2.7安装成功后，系统默认指向的python仍然是2.4.3版本，考虑到yum是基于python2.4.3才能正常工作，不敢轻易卸载。<br><em>解决方法：</em></p>
<ul>
<li><p>建立软连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mv /usr/bin/python /usr/bin/python.bak</span><br><span class="line">ln <span class="operator">-s</span> /usr/<span class="built_in">local</span>/bin/python2.<span class="number">7</span> /usr/bin/python</span><br></pre></td></tr></table></figure>
</li>
<li><p>使yum配置指向特定版本python2.4</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/bin/yum</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>将第一行显示的<code>#/usr/bin/python</code>修改为<code>#/usr/bin/python2.4</code><br>保存修改<code>:wq</code></p>
</li>
<li><p>继续上面的步骤重新安装NodeJS：</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/<span class="keyword">node</span><span class="identifier"></span><span class="title">-v0</span>.<span class="number">12.4</span></span><br><span class="line">./configure --<span class="variable">prefix=</span>/usr/local/nodejs</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>注意，又有新的错误：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ImportError: No module named bz2</span><br><span class="line">make[<span class="number">1</span>]: *** [/opt/node-v0.<span class="number">12.4</span>/out/Release/obj/gen/libraries.cc] 错误 <span class="number">1</span></span><br><span class="line">make[<span class="number">1</span>]: Leaving directory <span class="string">'/opt/node-v0.12.4/out'</span></span><br><span class="line">make: *** [node] 错误 <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>这个错误是由于python中没有装bz2的库导致的</p>
</li>
<li><p>继续安装bz2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install -y bzip2*</span><br><span class="line"><span class="built_in">cd</span> /opt/Python-<span class="number">2.7</span>.<span class="number">2</span>/Modules/zlib</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>重新安装python</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/Python-<span class="number">2.7</span><span class="number">.2</span>/</span><br><span class="line">python2<span class="number">.7</span> setup.py install</span><br></pre></td></tr></table></figure>
</li>
<li><p>继续上面的步骤重新安装NodeJS：</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/<span class="keyword">node</span><span class="identifier"></span><span class="title">-v0</span>.<span class="number">12.4</span></span><br><span class="line">./configure --<span class="variable">prefix=</span>/usr/local/nodejs</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>这次应该可以安装成功了</p>
</li>
<li><p>配置NodeJS环境变量</p>
<ul>
<li>进入profile编辑环境变量<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>在<code>export PATH USER LOGNAME MAIL HOSTNAME HISTSIZE HISTCONTROL</code> 一行的【上面】添加如下内容:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#set for nodejs</span></span><br><span class="line"><span class="built_in">export</span> NODE_HOME=/usr/<span class="built_in">local</span>/nodejs</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$NODE_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>
<p><code>:wq</code>保存并退出，编译/etc/profile 使配置生效</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>
<p>输入测试：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br></pre></td></tr></table></figure>
<p>得到版本号<code>v0.12.4</code></p>
</li>
</ol>
<h3 id="2-2_Ngnix_u5B89_u88C5"><a href="#2-2_Ngnix_u5B89_u88C5" class="headerlink" title="2.2 Ngnix安装"></a>2.2 Ngnix安装</h3><ol>
<li><p>在安装nginx前，需要确保系统安装了g++、gcc、openssl-devel、pcre-devel和zlib-devel 和libevent</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install pcre-devel  libevent  openssl</span><br><span class="line">yum -y install zlib zlib-devel  pcre</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载、解压安装Nginx</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget -c http://nginx.org/download/nginx-<span class="number">1.8</span>.<span class="number">0</span>.tar.gz</span><br><span class="line">tar –zxv –f nginx-<span class="number">1.8</span>.<span class="number">0</span>.tar.gz</span><br><span class="line"><span class="built_in">cd</span> nginx-<span class="number">1.8</span>.<span class="number">0</span></span><br><span class="line">./configure --prefix=/usr/<span class="built_in">local</span>/nginx</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试nginx<br>开启：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/nginx/sbin/nginx</span><br></pre></td></tr></table></figure>
<p>测试http访问</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl localhost</span><br></pre></td></tr></table></figure>
<p>得到以下输出信息表示成功安装并开启nginx</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">  &lt;!DOCTYPE html&gt;</span><br><span class="line">  &lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">  &lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br><span class="line">  &lt;style&gt;</span><br><span class="line">      body &#123;</span><br><span class="line">          width: <span class="number">35</span>em;</span><br><span class="line">          margin: <span class="number">0</span> auto;</span><br><span class="line">          font-family: Tahoma, Verdana, Arial, sans-serif;</span><br><span class="line">      &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span><br><span class="line">  &lt;p&gt;If you see this page, the nginx web server is successfully installed and</span><br><span class="line">  working. Further configuration is required.&lt;/p&gt;</span><br><span class="line">  &lt;p&gt;For online documentation and support please refer to</span><br><span class="line">  &lt;a href=<span class="string">"http://nginx.org/"</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</span><br><span class="line">  Commercial support is available at</span><br><span class="line">  &lt;a href=<span class="string">"http://nginx.com/"</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</span><br><span class="line">  &lt;p&gt;&lt;em&gt;Thank you <span class="keyword">for</span> using nginx.&lt;/em&gt;&lt;/p&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">  &lt;/html&gt;</span><br><span class="line">  &lt;/pre&gt;</span><br><span class="line">  ```  </span><br><span class="line"></span><br><span class="line"><span class="comment">## 3. 安装Countly Web Server</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>. 下载到/opt，并解压</span><br><span class="line">  ```bash</span><br><span class="line">  <span class="built_in">cd</span> /opt</span><br><span class="line">  wget –c https://github.com/Countly/countly-server/archive/master.zip</span><br><span class="line">  unzip countly-server-master.zip</span><br><span class="line">  mv ./countly-server-master ./countly</span><br></pre></td></tr></table></figure>
</li>
<li><p>复制countly web配置文件，并修改配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/countly/frontend/express/</span><br><span class="line">cp config.sample.js  config.js</span><br><span class="line">vi config.js</span><br></pre></td></tr></table></figure>
<p>将<code>mongodb</code>服务器地址<code>host</code>修改为<code>192.168.8.16</code>，保存并退出<br><code>:wq</code></p>
</li>
<li><p>复制api配置文件，并修改mongodb host</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ../../api/</span><br><span class="line">cp config.sample.js  config.js</span><br><span class="line">vi config.js</span><br></pre></td></tr></table></figure>
<p>将<code>mongodb</code>服务器地址<code>host</code>修改为<code>192.168.8.16</code>，保存并退出<br><code>:wq</code></p>
</li>
<li><p>复制 countly.config.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/countly/frontend/express/public/javascripts/countly/</span><br><span class="line">cp countly.config.sample.js  countly.config.js</span><br></pre></td></tr></table></figure>
</li>
<li><p>此时如果执行<code>node /opt/countly/api/api.js</code> node会报错误，没有time 组件，需要安装<code>time</code>组件<br>使用淘宝提供的源进行安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm --registry http://registry.cnpmjs.org/ install time</span><br></pre></td></tr></table></figure>
<p>这个时间比较长，会进行<code>node-gyp rebuild</code>,安装完成后，就可以测试<code>node /opt/countly/api/api.js</code>和 <code>node /opt/countly/frontend/express/app.js</code>了</p>
</li>
</ol>
<h2 id="4-__u914D_u7F6E_u670D_u52A1_u81EA_u542F_u52A8"><a href="#4-__u914D_u7F6E_u670D_u52A1_u81EA_u542F_u52A8" class="headerlink" title="4. 配置服务自启动"></a>4. 配置服务自启动</h2><h3 id="4-1__u5B89_u88C5supervisor__u8FDB_u7A0B_u7BA1_u7406_uFF0C_u8BBE_u7F6E_u81EA_u542F_u52A8"><a href="#4-1__u5B89_u88C5supervisor__u8FDB_u7A0B_u7BA1_u7406_uFF0C_u8BBE_u7F6E_u81EA_u542F_u52A8" class="headerlink" title="4.1 安装supervisor 进程管理，设置自启动"></a>4.1 安装supervisor 进程管理，设置自启动</h3><ol>
<li><p>下载并安装supervisor</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt &amp;&amp; wget -c --no-check-certificate https://pypi.python.org/packages/<span class="built_in">source</span>/s/supervisor/supervisor-<span class="number">3.1</span>.<span class="number">1</span>.tar.gz</span><br><span class="line">tar zxvf supervisor-<span class="number">3.1</span>.<span class="number">1</span>.tar.gz</span><br><span class="line"><span class="built_in">cd</span> supervisor-<span class="number">3.1</span>.<span class="number">1</span></span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>
<p><em>如果出现错误：</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"setup.py"</span>, line <span class="number">32</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    from setuptools import setup, find_packages</span><br><span class="line">ImportError: No module named setuptools</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载安装python组件：setuptools17.0</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">unzip setuptools-<span class="number">17.0</span>.zip</span><br><span class="line"><span class="built_in">cd</span> setuptools-<span class="number">17.0</span></span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>
</li>
<li><p>继续用python安装 supervisor</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/supervisor-<span class="number">3.1</span>.<span class="number">1</span></span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>
</li>
<li><p>编辑countly-supervisor.conf</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/countly/bin/config/supervisord.conf</span><br></pre></td></tr></table></figure>
<p>将<code>%(here)s/../..</code>和<code>%(here)s</code> 替换为<code>/opt/countly</code>,保存修改<code>:wq</code></p>
</li>
<li><p>配置supervisor文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span>_supervisord_conf &gt; /etc/supervisord.conf</span><br><span class="line">vi /etc/supervisord.conf</span><br></pre></td></tr></table></figure>
<p>将最后两行取消注释，改为：</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">include</span>]</span><br><span class="line">files = <span class="regexp">/opt/countly</span><span class="regexp">/bin/config</span><span class="regexp">/supervisord.conf</span></span><br></pre></td></tr></table></figure>
<p>保存 <code>:wq</code></p>
</li>
<li><p>配置supervisor 自启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/init.d/supervisor</span><br></pre></td></tr></table></figure>
<p>添加加入代码：  </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># supervisor Startup script for the Countly HTTP Server</span></span><br><span class="line"><span class="comment"># it is v.0.0.2 version.</span></span><br><span class="line"><span class="comment"># chkconfig: - 85 15</span></span><br><span class="line"><span class="comment"># description: Countly</span></span><br><span class="line"><span class="comment"># processname: supervisor</span></span><br><span class="line"><span class="comment"># pidfile: /var/run/supervisor.pid</span></span><br><span class="line"><span class="comment"># config: /etc/supervisord.conf</span></span><br><span class="line"></span><br><span class="line">supervisordd=/usr/<span class="built_in">local</span>/bin/supervisord</span><br><span class="line">supervisor_config=/etc/supervisord.conf</span><br><span class="line">supervisor_pid=/var/run/supervisor.pid</span><br><span class="line"></span><br><span class="line">RETVAL=<span class="number">0</span></span><br><span class="line">prog=<span class="string">"supervisor"</span></span><br><span class="line"><span class="comment"># Source function library.</span></span><br><span class="line">. /etc/rc.d/init.d/<span class="built_in">functions</span></span><br><span class="line"><span class="comment"># Source networking configuration.</span></span><br><span class="line">. /etc/sysconfig/network</span><br><span class="line"><span class="comment"># Check that networking is up.</span></span><br><span class="line"></span><br><span class="line">[ <span class="variable">$&#123;NETWORKING&#125;</span> = <span class="string">"no"</span> ] &amp;&amp; <span class="built_in">exit</span> <span class="number">0</span></span><br><span class="line">[ -x <span class="variable">$supervisordd</span> ] || <span class="built_in">exit</span> <span class="number">0</span></span><br><span class="line"><span class="comment"># Start supervisor daemons functions.</span></span><br><span class="line"><span class="function"><span class="title">start</span></span>() &#123;</span><br><span class="line">PATH=/sbin:/usr/sbin:/bin:/usr/bin:/usr/<span class="built_in">local</span>/nodejs/bin</span><br><span class="line"><span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$supervisor_pid</span> ];<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"supervisor already running...."</span></span><br><span class="line">   <span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">   <span class="built_in">echo</span>  $<span class="string">"Starting <span class="variable">$prog</span> with conf:<span class="variable">$supervisor_config</span>"</span></span><br><span class="line">daemon <span class="variable">$supervisordd</span> --configuration <span class="variable">$&#123;supervisor_config&#125;</span></span><br><span class="line">   RETVAL=$?</span><br><span class="line">   <span class="built_in">echo</span></span><br><span class="line">   [ <span class="variable">$RETVAL</span> = <span class="number">0</span> ] &amp;&amp; touch /var/lock/subsys/supervisor</span><br><span class="line">   <span class="built_in">return</span> <span class="variable">$RETVAL</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Stop supervisor daemons functions.</span></span><br><span class="line"><span class="function"><span class="title">stop</span></span>() &#123;</span><br><span class="line">        <span class="built_in">echo</span> -n $<span class="string">"Stopping <span class="variable">$prog</span>: "</span></span><br><span class="line">        killproc <span class="variable">$supervisordd</span></span><br><span class="line">        RETVAL=$?</span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line">        [ <span class="variable">$RETVAL</span> = <span class="number">0</span> ] &amp;&amp; rm <span class="operator">-f</span> /var/lock/subsys/supervisor /var/run/supervisor.pid</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># reload supervisor service functions.</span></span><br><span class="line"><span class="function"><span class="title">reload</span></span>() &#123;</span><br><span class="line"> PATH=/sbin:/usr/sbin:/bin:/usr/bin:/usr/<span class="built_in">local</span>/nodejs/bin</span><br><span class="line">    <span class="built_in">echo</span> -n $<span class="string">"Reloading <span class="variable">$prog</span>: "</span></span><br><span class="line">    <span class="comment">#kill -HUP `cat $&#123;supervisor_pid&#125;`</span></span><br><span class="line">    killproc <span class="variable">$supervisordd</span> -HUP</span><br><span class="line">    RETVAL=$?</span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># See how we were called.</span></span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line">        start</span><br><span class="line">        ;;</span><br><span class="line">stop)</span><br><span class="line">        stop</span><br><span class="line">        ;;</span><br><span class="line">reload)</span><br><span class="line">        reload</span><br><span class="line">        ;;</span><br><span class="line">restart)</span><br><span class="line">        stop</span><br><span class="line">        start</span><br><span class="line">        ;;</span><br><span class="line">status)</span><br><span class="line">        status <span class="variable">$prog</span></span><br><span class="line">        RETVAL=$?</span><br><span class="line">        ;;</span><br><span class="line">*)</span><br><span class="line">        <span class="built_in">echo</span> $<span class="string">"Usage: <span class="variable">$prog</span> &#123;start|stop|restart|reload|status|help&#125;"</span></span><br><span class="line">        <span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"><span class="built_in">exit</span> <span class="variable">$RETVAL</span></span><br></pre></td></tr></table></figure>
<p>保存修改 <code>:wq</code><br>设置文件属性为可执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod a+x /etc/init.d/supervisor</span><br></pre></td></tr></table></figure>
<p>测试：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service supervisor start</span><br></pre></td></tr></table></figure>
<p>可以看到：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Starting supervisor with conf:/etc/supervisord.conf</span><br><span class="line"></span><br><span class="line">                                                           [确定]</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加到开机启动项中：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/rc.local</span><br></pre></td></tr></table></figure>
<p>加入：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/supervisor start</span><br></pre></td></tr></table></figure>
<p>保存 <code>:wq</code></p>
</li>
</ol>
<h3 id="4-2__u914D_u7F6ENginx_u81EA_u542F_u52A8"><a href="#4-2__u914D_u7F6ENginx_u81EA_u542F_u52A8" class="headerlink" title="4.2 配置Nginx自启动"></a>4.2 配置Nginx自启动</h3><ol>
<li><p>添加nginx脚本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/init.d/nginx</span><br></pre></td></tr></table></figure>
<p>加入下面的内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># nginx Startup script for the Nginx HTTP Server</span></span><br><span class="line"><span class="comment"># it is v.0.0.2 version.</span></span><br><span class="line"><span class="comment"># chkconfig: - 85 15</span></span><br><span class="line"><span class="comment"># description: Nginx is a high-performance web and proxy server.</span></span><br><span class="line"><span class="comment">#              It has a lot of features, but it's not for everyone.</span></span><br><span class="line"><span class="comment"># processname: nginx</span></span><br><span class="line"><span class="comment"># pidfile: /var/run/nginx.pid</span></span><br><span class="line"><span class="comment"># config: /usr/local/nginx/conf/nginx.conf</span></span><br><span class="line">nginxd=/usr/<span class="built_in">local</span>/nginx/sbin/nginx</span><br><span class="line">nginx_config=/usr/<span class="built_in">local</span>/nginx/conf/nginx.conf</span><br><span class="line">nginx_pid=/var/run/nginx.pid</span><br><span class="line">RETVAL=<span class="number">0</span></span><br><span class="line">prog=<span class="string">"nginx"</span></span><br><span class="line"><span class="comment"># Source function library.</span></span><br><span class="line">. /etc/rc.d/init.d/<span class="built_in">functions</span></span><br><span class="line"><span class="comment"># Source networking configuration.</span></span><br><span class="line">. /etc/sysconfig/network</span><br><span class="line"><span class="comment"># Check that networking is up.</span></span><br><span class="line">[ <span class="variable">$&#123;NETWORKING&#125;</span> = <span class="string">"no"</span> ] &amp;&amp; <span class="built_in">exit</span> <span class="number">0</span></span><br><span class="line">[ -x <span class="variable">$nginxd</span> ] || <span class="built_in">exit</span> <span class="number">0</span></span><br><span class="line"><span class="comment"># Start nginx daemons functions.</span></span><br><span class="line"><span class="function"><span class="title">start</span></span>() &#123;</span><br><span class="line"><span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$nginx_pid</span> ];<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"nginx already running...."</span></span><br><span class="line">   <span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">   <span class="built_in">echo</span> -n $<span class="string">"Starting <span class="variable">$prog</span>: "</span></span><br><span class="line">   daemon <span class="variable">$nginxd</span> -c <span class="variable">$&#123;nginx_config&#125;</span></span><br><span class="line">   RETVAL=$?</span><br><span class="line">   <span class="built_in">echo</span></span><br><span class="line">   [ <span class="variable">$RETVAL</span> = <span class="number">0</span> ] &amp;&amp; touch /var/lock/subsys/nginx</span><br><span class="line">   <span class="built_in">return</span> <span class="variable">$RETVAL</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># Stop nginx daemons functions.</span></span><br><span class="line"><span class="function"><span class="title">stop</span></span>() &#123;</span><br><span class="line">        <span class="built_in">echo</span> -n $<span class="string">"Stopping <span class="variable">$prog</span>: "</span></span><br><span class="line">        killproc <span class="variable">$nginxd</span></span><br><span class="line">        RETVAL=$?</span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line">        [ <span class="variable">$RETVAL</span> = <span class="number">0</span> ] &amp;&amp; rm <span class="operator">-f</span> /var/lock/subsys/nginx /var/run/nginx.pid</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># reload nginx service functions.</span></span><br><span class="line"><span class="function"><span class="title">reload</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -n $<span class="string">"Reloading <span class="variable">$prog</span>: "</span></span><br><span class="line">    <span class="comment">#kill -HUP `cat $&#123;nginx_pid&#125;`</span></span><br><span class="line">    killproc <span class="variable">$nginxd</span> -HUP</span><br><span class="line">    RETVAL=$?</span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># See how we were called.</span></span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line">        start</span><br><span class="line">        ;;</span><br><span class="line">stop)</span><br><span class="line">        stop</span><br><span class="line">        ;;</span><br><span class="line">reload)</span><br><span class="line">        reload</span><br><span class="line">        ;;</span><br><span class="line">restart)</span><br><span class="line">        stop</span><br><span class="line">        start</span><br><span class="line">        ;;</span><br><span class="line">status)</span><br><span class="line">        status <span class="variable">$prog</span></span><br><span class="line">        RETVAL=$?</span><br><span class="line">        ;;</span><br><span class="line">*)</span><br><span class="line">        <span class="built_in">echo</span> $<span class="string">"Usage: <span class="variable">$prog</span> &#123;start|stop|restart|reload|status|help&#125;"</span></span><br><span class="line">        <span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"><span class="built_in">exit</span> <span class="variable">$RETVAL</span></span><br></pre></td></tr></table></figure>
<p>保存并退出<code>:wq</code><br>设置文件的访问权限(<code>a+x</code> ==&gt; all user can execute  所有用户可执行)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod a+x /etc/init.d/nginx</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加到开机启动项中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/rc.local</span><br></pre></td></tr></table></figure>
<p>加入一行<code>/etc/init.d/nginx start</code>保存并退出，下次重启会生效。</p>
</li>
<li><p>完成所有配置,重启服务器。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure>
</li>
<li><p>重新打开terminal输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl localhost</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Moved Temporarily. Redirecting to /login</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="5-__u8BF4_u660E"><a href="#5-__u8BF4_u660E" class="headerlink" title="5. 说明"></a>5. 说明</h2><p>过程中参考了这些文章<br>安装中文语言支持包<br><a href="http://www.xshell.net/linux/GNOM.html" target="_blank" rel="external">http://www.xshell.net/linux/GNOM.html</a></p>
<p>CentOS安装NodeJS<br><a href="http://zhaohe162.blog.163.com/blog/static/38216797201402234212981/" target="_blank" rel="external">http://zhaohe162.blog.163.com/blog/static/38216797201402234212981/</a></p>
<p>给nodejs的npm更换源<br><a href="http://blog.sina.com.cn/s/blog_77a8ce670101cdd3.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_77a8ce670101cdd3.html</a></p>
<p>升级CentOS5.6_X64 python2.4.3到2.7<br><a href="http://hxl2009.blog.51cto.com/779549/1031310" target="_blank" rel="external">http://hxl2009.blog.51cto.com/779549/1031310</a></p>
<p>python中没有装bz2的库<br><a href="http://flyer2010.iteye.com/blog/1699946" target="_blank" rel="external">http://flyer2010.iteye.com/blog/1699946</a></p>
<p>配置环境变量<br><a href="http://blog.csdn.net/zhaoweitco/article/details/12677089" target="_blank" rel="external">http://blog.csdn.net/zhaoweitco/article/details/12677089</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>由于工作需要，需要在CentOS 5.5 下安装Countly Web Server，把过程记录下来</p>]]>
    
    </summary>
    
      <category term="Cent OS" scheme="http://lulee007.gitcafe.io/tagsCN/Cent-OS/"/>
    
      <category term="Countly Web Server" scheme="http://lulee007.gitcafe.io/tagsCN/Countly-Web-Server/"/>
    
      <category term="笔记" scheme="http://lulee007.gitcafe.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
</feed>
